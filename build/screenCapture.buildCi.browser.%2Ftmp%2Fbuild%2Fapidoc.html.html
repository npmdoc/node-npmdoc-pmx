<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/keymetrics/pmx#readme">pmx (v1.1.0)</a>
</h1>
<h4>PM2/Keymetrics advanced API</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx">module pmx</a><ol>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">pmx.</span>_started</span>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.BinaryHeap">
            function <span class="apidocSignatureSpan">pmx.</span>BinaryHeap
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.EDS">
            function <span class="apidocSignatureSpan">pmx.</span>EDS
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.EWMA">
            function <span class="apidocSignatureSpan">pmx.</span>EWMA
            <span class="apidocSignatureSpan">(timePeriod, tickInterval)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx._interpretError">
            function <span class="apidocSignatureSpan">pmx.</span>_interpretError
            <span class="apidocSignatureSpan">(err)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.action">
            function <span class="apidocSignatureSpan">pmx.</span>action
            <span class="apidocSignatureSpan">(action_name, opts, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.alert">
            function <span class="apidocSignatureSpan">pmx.</span>alert
            <span class="apidocSignatureSpan">(opts, extra)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.catchAll">
            function <span class="apidocSignatureSpan">pmx.</span>catchAll
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.catchPorts">
            function <span class="apidocSignatureSpan">pmx.</span>catchPorts
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.catchTraffic">
            function <span class="apidocSignatureSpan">pmx.</span>catchTraffic
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.configureModule">
            function <span class="apidocSignatureSpan">pmx.</span>configureModule
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.datachecker">
            function <span class="apidocSignatureSpan">pmx.</span>datachecker
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.detectV8Profiler">
            function <span class="apidocSignatureSpan">pmx.</span>detectV8Profiler
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.emit">
            function <span class="apidocSignatureSpan">pmx.</span>emit
            <span class="apidocSignatureSpan">(name, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.enableProbe">
            function <span class="apidocSignatureSpan">pmx.</span>enableProbe
            <span class="apidocSignatureSpan">(custom_namespace)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.enableProbes">
            function <span class="apidocSignatureSpan">pmx.</span>enableProbes
            <span class="apidocSignatureSpan">(custom_namespace)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.exposeProfiling">
            function <span class="apidocSignatureSpan">pmx.</span>exposeProfiling
            <span class="apidocSignatureSpan">(pmx, profiler_path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.expressErrorHandler">
            function <span class="apidocSignatureSpan">pmx.</span>expressErrorHandler
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.getConf">
            function <span class="apidocSignatureSpan">pmx.</span>getConf
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.getEnv">
            function <span class="apidocSignatureSpan">pmx.</span>getEnv
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.getPID">
            function <span class="apidocSignatureSpan">pmx.</span>getPID
            <span class="apidocSignatureSpan">(file)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.http">
            function <span class="apidocSignatureSpan">pmx.</span>http
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.init">
            function <span class="apidocSignatureSpan">pmx.</span>init
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.initModule">
            function <span class="apidocSignatureSpan">pmx.</span>initModule
            <span class="apidocSignatureSpan">(opts, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.notify">
            function <span class="apidocSignatureSpan">pmx.</span>notify
            <span class="apidocSignatureSpan">(err)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.probe">
            function <span class="apidocSignatureSpan">pmx.</span>probe
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.resolvePidPaths">
            function <span class="apidocSignatureSpan">pmx.</span>resolvePidPaths
            <span class="apidocSignatureSpan">(filepaths)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.sample">
            function <span class="apidocSignatureSpan">pmx.</span>sample
            <span class="apidocSignatureSpan">(size)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.scopedAction">
            function <span class="apidocSignatureSpan">pmx.</span>scopedAction
            <span class="apidocSignatureSpan">(action_name, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.stopProbe">
            function <span class="apidocSignatureSpan">pmx.</span>stopProbe
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.stopProbes">
            function <span class="apidocSignatureSpan">pmx.</span>stopProbes
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.tracing">
            function <span class="apidocSignatureSpan">pmx.</span>tracing
            <span class="apidocSignatureSpan">(pmx, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.v8Profiling">
            function <span class="apidocSignatureSpan">pmx.</span>v8Profiling
            <span class="apidocSignatureSpan">(pmx)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan"></span>pmx</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>AVAILABLE_AGG_TYPES</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>AVAILABLE_MEASUREMENTS</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>BinaryHeap.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>EDS.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>EWMA.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>Probe</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>_pmx_conf</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>_var</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>actions</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>alert.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>common</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>configuration</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>datachecker.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>events</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>monitor</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>network</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>profiling</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>proxy</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>sample.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>transaction</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.</span>transport</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">pmx.</span>default_aggregation</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.BinaryHeap">module pmx.BinaryHeap</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.BinaryHeap.BinaryHeap">
            function <span class="apidocSignatureSpan">pmx.</span>BinaryHeap
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.BinaryHeap.prototype">module pmx.BinaryHeap.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.BinaryHeap.prototype._bubble">
            function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>_bubble
            <span class="apidocSignatureSpan">(bubbleIndex)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.BinaryHeap.prototype._childIndexes">
            function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>_childIndexes
            <span class="apidocSignatureSpan">(index)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.BinaryHeap.prototype._parentIndex">
            function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>_parentIndex
            <span class="apidocSignatureSpan">(index)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.BinaryHeap.prototype._score">
            function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>_score
            <span class="apidocSignatureSpan">(element)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.BinaryHeap.prototype._sink">
            function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>_sink
            <span class="apidocSignatureSpan">(sinkIndex)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.BinaryHeap.prototype.add">
            function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>add
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.BinaryHeap.prototype.clone">
            function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>clone
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.BinaryHeap.prototype.first">
            function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>first
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.BinaryHeap.prototype.removeFirst">
            function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>removeFirst
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.BinaryHeap.prototype.size">
            function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>size
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.BinaryHeap.prototype.toArray">
            function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>toArray
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.BinaryHeap.prototype.toSortedArray">
            function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>toSortedArray
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.EDS">module pmx.EDS</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.EDS.EDS">
            function <span class="apidocSignatureSpan">pmx.</span>EDS
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">pmx.EDS.</span>ALPHA</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">pmx.EDS.</span>RESCALE_INTERVAL</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">pmx.EDS.</span>SIZE</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.EDS.prototype">module pmx.EDS.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.EDS.prototype._priority">
            function <span class="apidocSignatureSpan">pmx.EDS.prototype.</span>_priority
            <span class="apidocSignatureSpan">(age)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.EDS.prototype._random">
            function <span class="apidocSignatureSpan">pmx.EDS.prototype.</span>_random
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.EDS.prototype._rescale">
            function <span class="apidocSignatureSpan">pmx.EDS.prototype.</span>_rescale
            <span class="apidocSignatureSpan">(now)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.EDS.prototype._weight">
            function <span class="apidocSignatureSpan">pmx.EDS.prototype.</span>_weight
            <span class="apidocSignatureSpan">(age)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.EDS.prototype.avg">
            function <span class="apidocSignatureSpan">pmx.EDS.prototype.</span>avg
            <span class="apidocSignatureSpan">(now)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.EDS.prototype.toArray">
            function <span class="apidocSignatureSpan">pmx.EDS.prototype.</span>toArray
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.EDS.prototype.toSortedArray">
            function <span class="apidocSignatureSpan">pmx.EDS.prototype.</span>toSortedArray
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.EDS.prototype.update">
            function <span class="apidocSignatureSpan">pmx.EDS.prototype.</span>update
            <span class="apidocSignatureSpan">(value, timestamp)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.EWMA">module pmx.EWMA</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.EWMA.EWMA">
            function <span class="apidocSignatureSpan">pmx.</span>EWMA
            <span class="apidocSignatureSpan">(timePeriod, tickInterval)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">pmx.EWMA.</span>TICK_INTERVAL</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.EWMA.prototype">module pmx.EWMA.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.EWMA.prototype.rate">
            function <span class="apidocSignatureSpan">pmx.EWMA.prototype.</span>rate
            <span class="apidocSignatureSpan">(timeUnit)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.EWMA.prototype.tick">
            function <span class="apidocSignatureSpan">pmx.EWMA.prototype.</span>tick
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.EWMA.prototype.update">
            function <span class="apidocSignatureSpan">pmx.EWMA.prototype.</span>update
            <span class="apidocSignatureSpan">(n)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.Probe">module pmx.Probe</a><ol>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">pmx.Probe.</span>_started</span>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.Probe.probe">
            function <span class="apidocSignatureSpan">pmx.Probe.</span>probe
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.Probe.</span>AVAILABLE_AGG_TYPES</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.Probe.</span>AVAILABLE_MEASUREMENTS</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.Probe.</span>_var</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">pmx.Probe.</span>default_aggregation</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.actions">module pmx.actions</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.actions.action">
            function <span class="apidocSignatureSpan">pmx.actions.</span>action
            <span class="apidocSignatureSpan">(action_name, opts, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.actions.scopedAction">
            function <span class="apidocSignatureSpan">pmx.actions.</span>scopedAction
            <span class="apidocSignatureSpan">(action_name, fn)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.alert">module pmx.alert</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.alert.alert">
            function <span class="apidocSignatureSpan">pmx.</span>alert
            <span class="apidocSignatureSpan">(opts, extra)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.alert.prototype">module pmx.alert.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.alert.prototype.serialize">
            function <span class="apidocSignatureSpan">pmx.alert.prototype.</span>serialize
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.alert.prototype.tick">
            function <span class="apidocSignatureSpan">pmx.alert.prototype.</span>tick
            <span class="apidocSignatureSpan">(value)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.common">module pmx.common</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.common.getDate">
            function <span class="apidocSignatureSpan">pmx.common.</span>getDate
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.configuration">module pmx.configuration</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.configuration.configureModule">
            function <span class="apidocSignatureSpan">pmx.configuration.</span>configureModule
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.configuration.getPID">
            function <span class="apidocSignatureSpan">pmx.configuration.</span>getPID
            <span class="apidocSignatureSpan">(file)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.configuration.init">
            function <span class="apidocSignatureSpan">pmx.configuration.</span>init
            <span class="apidocSignatureSpan">(conf, do_not_tell_pm2)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.configuration.resolvePidPaths">
            function <span class="apidocSignatureSpan">pmx.configuration.</span>resolvePidPaths
            <span class="apidocSignatureSpan">(filepaths)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.datachecker">module pmx.datachecker</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.datachecker.datachecker">
            function <span class="apidocSignatureSpan">pmx.</span>datachecker
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.datachecker.prototype">module pmx.datachecker.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.datachecker.prototype.medianDev">
            function <span class="apidocSignatureSpan">pmx.datachecker.prototype.</span>medianDev
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.datachecker.prototype.normalDev">
            function <span class="apidocSignatureSpan">pmx.datachecker.prototype.</span>normalDev
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.datachecker.prototype.start">
            function <span class="apidocSignatureSpan">pmx.datachecker.prototype.</span>start
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.datachecker.prototype.stop">
            function <span class="apidocSignatureSpan">pmx.datachecker.prototype.</span>stop
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.events">module pmx.events</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.events.emit">
            function <span class="apidocSignatureSpan">pmx.events.</span>emit
            <span class="apidocSignatureSpan">(name, data)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.monitor">module pmx.monitor</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.monitor.enableProbe">
            function <span class="apidocSignatureSpan">pmx.monitor.</span>enableProbe
            <span class="apidocSignatureSpan">(custom_namespace)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.monitor.enableProbes">
            function <span class="apidocSignatureSpan">pmx.monitor.</span>enableProbes
            <span class="apidocSignatureSpan">(custom_namespace)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.monitor.stopProbe">
            function <span class="apidocSignatureSpan">pmx.monitor.</span>stopProbe
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.monitor.stopProbes">
            function <span class="apidocSignatureSpan">pmx.monitor.</span>stopProbes
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.network">module pmx.network</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.network.catchPorts">
            function <span class="apidocSignatureSpan">pmx.network.</span>catchPorts
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.network.catchTraffic">
            function <span class="apidocSignatureSpan">pmx.network.</span>catchTraffic
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.notify">module pmx.notify</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.notify.notify">
            function <span class="apidocSignatureSpan">pmx.</span>notify
            <span class="apidocSignatureSpan">(err)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.notify._interpretError">
            function <span class="apidocSignatureSpan">pmx.notify.</span>_interpretError
            <span class="apidocSignatureSpan">(err)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.notify.catchAll">
            function <span class="apidocSignatureSpan">pmx.notify.</span>catchAll
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.notify.expressErrorHandler">
            function <span class="apidocSignatureSpan">pmx.notify.</span>expressErrorHandler
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.pmx">module pmx.pmx</a><ol>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">pmx.pmx.</span>_started</span>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx._interpretError">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>_interpretError
            <span class="apidocSignatureSpan">(err)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.action">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>action
            <span class="apidocSignatureSpan">(action_name, opts, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.catchAll">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>catchAll
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.catchPorts">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>catchPorts
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.catchTraffic">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>catchTraffic
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.configureModule">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>configureModule
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.detectV8Profiler">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>detectV8Profiler
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.emit">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>emit
            <span class="apidocSignatureSpan">(name, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.enableProbe">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>enableProbe
            <span class="apidocSignatureSpan">(custom_namespace)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.enableProbes">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>enableProbes
            <span class="apidocSignatureSpan">(custom_namespace)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.exposeProfiling">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>exposeProfiling
            <span class="apidocSignatureSpan">(pmx, profiler_path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.expressErrorHandler">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>expressErrorHandler
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.getConf">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>getConf
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.getEnv">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>getEnv
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.getPID">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>getPID
            <span class="apidocSignatureSpan">(file)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.http">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>http
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.init">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>init
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.initModule">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>initModule
            <span class="apidocSignatureSpan">(opts, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.notify">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>notify
            <span class="apidocSignatureSpan">(err)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.probe">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>probe
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.resolvePidPaths">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>resolvePidPaths
            <span class="apidocSignatureSpan">(filepaths)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.scopedAction">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>scopedAction
            <span class="apidocSignatureSpan">(action_name, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.stopProbe">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>stopProbe
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.stopProbes">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>stopProbes
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.tracing">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>tracing
            <span class="apidocSignatureSpan">(pmx, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.pmx.v8Profiling">
            function <span class="apidocSignatureSpan">pmx.pmx.</span>v8Profiling
            <span class="apidocSignatureSpan">(pmx)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.pmx.</span>AVAILABLE_AGG_TYPES</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.pmx.</span>AVAILABLE_MEASUREMENTS</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.pmx.</span>_pmx_conf</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pmx.pmx.</span>_var</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">pmx.pmx.</span>default_aggregation</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.profiling">module pmx.profiling</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.profiling.detectV8Profiler">
            function <span class="apidocSignatureSpan">pmx.profiling.</span>detectV8Profiler
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.profiling.exposeProfiling">
            function <span class="apidocSignatureSpan">pmx.profiling.</span>exposeProfiling
            <span class="apidocSignatureSpan">(pmx, profiler_path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.profiling.v8Profiling">
            function <span class="apidocSignatureSpan">pmx.profiling.</span>v8Profiling
            <span class="apidocSignatureSpan">(pmx)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.proxy">module pmx.proxy</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.proxy.wrap">
            function <span class="apidocSignatureSpan">pmx.proxy.</span>wrap
            <span class="apidocSignatureSpan">(object, methods, hook)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.sample">module pmx.sample</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.sample.sample">
            function <span class="apidocSignatureSpan">pmx.</span>sample
            <span class="apidocSignatureSpan">(size)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.sample.prototype">module pmx.sample.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.sample.prototype.getMean">
            function <span class="apidocSignatureSpan">pmx.sample.prototype.</span>getMean
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.sample.prototype.getStddev">
            function <span class="apidocSignatureSpan">pmx.sample.prototype.</span>getStddev
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.sample.prototype.getVariance">
            function <span class="apidocSignatureSpan">pmx.sample.prototype.</span>getVariance
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.sample.prototype.update">
            function <span class="apidocSignatureSpan">pmx.sample.prototype.</span>update
            <span class="apidocSignatureSpan">(value)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.transaction">module pmx.transaction</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.transaction.http">
            function <span class="apidocSignatureSpan">pmx.transaction.</span>http
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.transaction.tracing">
            function <span class="apidocSignatureSpan">pmx.transaction.</span>tracing
            <span class="apidocSignatureSpan">(pmx, opts)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pmx.transport">module pmx.transport</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pmx.transport.send">
            function <span class="apidocSignatureSpan">pmx.transport.</span>send
            <span class="apidocSignatureSpan">(args, print)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx" id="apidoc.module.pmx">module pmx</a></h1>




    <h2>
        <a href="#apidoc.element.pmx.BinaryHeap" id="apidoc.element.pmx.BinaryHeap">
        function <span class="apidocSignatureSpan">pmx.</span>BinaryHeap
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function BinaryHeap(options) {
  options = options || {};

  this._elements = options.elements || [];
  this._score    = options.score || this._score;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.EDS" id="apidoc.element.pmx.EDS">
        function <span class="apidocSignatureSpan">pmx.</span>EDS
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ExponentiallyDecayingSample(options) {
  options = options || {};

  this._elements = new BinaryHeap({
    score: function(element) {
      return -element.priority;
    }
  });

  this._rescaleInterval = options.rescaleInterval || ExponentiallyDecayingSample.RESCALE_INTERVAL;
  this._alpha           = options.alpha || ExponentiallyDecayingSample.ALPHA;
  this._size            = options.size || ExponentiallyDecayingSample.SIZE;
  this._random          = options.random || this._random;
  this._landmark        = null;
  this._nextRescale     = null;
  this._mean            = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.EWMA" id="apidoc.element.pmx.EWMA">
        function <span class="apidocSignatureSpan">pmx.</span>EWMA
        <span class="apidocSignatureSpan">(timePeriod, tickInterval)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ExponentiallyWeightedMovingAverage(timePeriod, tickInterval) {
  this._timePeriod   = timePeriod || 1 * units.MINUTE;
  this._tickInterval = tickInterval || ExponentiallyWeightedMovingAverage.TICK_INTERVAL;
  this._alpha        = 1 - Math.exp(-this._tickInterval / this._timePeriod);
  this._count        = 0;
  this._rate         = 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx._interpretError" id="apidoc.element.pmx._interpretError">
        function <span class="apidocSignatureSpan">pmx.</span>_interpretError
        <span class="apidocSignatureSpan">(err)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_interpretError = function (err) {
  var s_err = {};

  if (typeof(err) === 'string') {
    // Simple string processing
    s_err.message = err;
    s_err.stack = err;
  }
  else if (!(err instanceof Error) &amp;&amp; typeof(err) === 'object') {
    // JSON processing
    s_err.message = err;
    s_err.stack = err;
  }
  else if (err instanceof Error) {
    // Error object type processing
    err.stack;
    if (err.__error_callsites) {
      var stackFrames = [];
       err.__error_callsites.forEach(function(callSite) {
        stackFrames.push({ file_name: callSite.getFileName(), line_number: callSite.getLineNumber()});
      });
      err.stackframes = stackFrames;
      delete err.__error_callsites;
    }
    s_err = err;
  }

  return jsonize(s_err);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

if (listener === 'unhandledRejection') {
  error = 'You have triggered an unhandledRejection, you may have forgotten to catch a Promise rejection:\n' + error;
}

console.error(error);
if (err)
  var errObj = Notify.<span class="apidocCodeKeywordSpan">_interpretError</span>(err);

Transport.send({
  type : 'process:exception',
  data : errObj !== undefined ? errObj : {message: 'No error but ' + listener + ' was caught!' }
}, true);

if (!process.listeners(listener).filter(function (listener) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.action" id="apidoc.element.pmx.action">
        function <span class="apidocSignatureSpan">pmx.</span>action
        <span class="apidocSignatureSpan">(action_name, opts, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">action = function (action_name, opts, fn) {
  if (!fn) {
    fn = opts;
    opts = null;
  }

  if (!action_name)
    return console.error('[PMX] action.action_name is missing');
  if (!fn)
    return console.error('[PMX] emit.data is mission');

  if (!process.send) {
    debug('Process not running within PM2');
    return false;
  }

  // Notify the action
  Transport.send({
    type : 'axm:action',
    data : {
      action_name : action_name,
      opts        : opts,
      arity       : fn.length
    }
  });

  function reply(data) {
    if (data.length) {
      data._length = data.length;
      delete data.length;
    }

    Transport.send({
      type        : 'axm:reply',
      data        : {
        return      : data,
        action_name : action_name
      }
    });
  }

  process.on('message', function(data) {
    if (!data) return false;

    // In case 2 arguments has been set but no options has been transmitted
    if (fn.length === 2 &amp;&amp; typeof(data) === 'string' &amp;&amp; data === action_name)
      return fn({}, reply);

    // In case 1 arguments has been set but options has been transmitted
    if (fn.length === 1 &amp;&amp; typeof(data) === 'object' &amp;&amp; data.msg === action_name)
      return fn(reply);

<span class="apidocCodeCommentSpan">    /**
     * Classical call
     */
</span>    if (typeof(data) === 'string' &amp;&amp; data === action_name)
      return fn(reply);

    /**
     * If data is an object == v2 protocol
     * Pass the opts as first argument
     */
    if (typeof(data) === 'object' &amp;&amp; data.msg === action_name)
      return fn(data.opts, reply);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Simple action allows to trigger a function from Keymetrics. The function takes a function as a parameter (reply here) and need to
 be called once the job is finished.

Example:

```javascript
var pmx = require('pmx');

pmx.<span class="apidocCodeKeywordSpan">action</span>('db:clean', function(reply) {
  clean.db(function() {
    /**
     * reply() must be called at the end of the action
     */
     reply({success : true});
  });
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.alert" id="apidoc.element.pmx.alert">
        function <span class="apidocSignatureSpan">pmx.</span>alert
        <span class="apidocSignatureSpan">(opts, extra)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">alert = function (opts, extra) {
  var self = this;
  var cmp;

  if (typeof(opts.mode) === 'undefined')
    return console.error('[Probe][Metric] Mode undefined!');
  if (typeof(opts.cmp) === 'string') {
    switch(opts.cmp) {
      case '&gt;':
      cmp = function(a,b) {
          return (a &gt; b);
        };
        break;
      case '&lt;':
       cmp = function(a, b) {
          return (a &lt; b);
        };
        break;
      case '=':
         cmp = function(a,b) {
          return (a === b);
        };
        break;
      default:
        return console.error('[Probe][Metric] Mode does not exist!');
    }
    self.cmp_mode = opts.cmp;
    opts.cmp = null;
  }
  else {
    cmp = function(a,b) {
      return (a &gt; b);
    };
    self.cmp_mode = '&gt;';
  }
  switch(opts.mode) {
    case 'threshold':
      if (typeof(opts.value) === 'undefined')
        return console.error('[Probe][Metric][threshold] Val undefined!');
      this.cmp = opts.cmp || function(a,b) {
        return cmp(parseFloat(a), b);
      };
      break;
    case 'threshold-avg':
      if (typeof(opts.value) === 'undefined')
        return console.error('[Probe][Metric][threshold-avg] Val undefined!');
      this.sample = new Sample(opts.interval || 180);
      this.cmp = function(value, threshold) {
        this.sample.update(parseFloat(value));
        if (this.start) {
          if (typeof(opts.cmp) !== 'undefined' &amp;&amp; opts.cmp !== null)
            return opts.cmp(this.sample.getMean(), threshold);
          return cmp(this.sample.getMean(), threshold);
        }
      };
      break;
    case 'smart':
      this.sample = new Sample(opts.interval || 300);
      this.small = new Sample(opts.sample || 30);
      this.cmp = function(value, threshold) {
        if (value !== null) {
          this.sample.update(parseFloat(value));
          this.small.update(parseFloat(value));
        //debug('Check', value, Math.exp(- Math.pow(value - this.sample.getMean(), 2) / (2 * this.sample.getVariance())) / (Math
.sqrt(2 * Math.PI) * this.sample.getStddev()));

          if (this.start)
          //return false
            return (Math.exp(- Math.pow(value - this.sample.getMean(), 2) / (2 * this.sample.getVariance())) / (Math.sqrt(2 * Math
.PI) * this.sample.getStddev()) &lt; 0.00000001)
        }
        return false;
      };
      break;
    default:
      return console.error('[Probe][Metric] Mode does not exist!');
  }
  this.mode = opts.mode;
  this.start = false;
  //Start the data checking after 30s (default)
  setTimeout(function() {
    self.start = true;
  }, opts.timeout || 30000);
  this.reached = 0;
  this.nullCheck = 0;
  this.value =  opts.value || null;
  this.msg = opts.msg || ((extra &amp;&amp; extra.name) ? ('Probe ' + extra.name + ' has reached value') : 'Alert value reached');
  this.func = opts.func || opts.action || null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.catchAll" id="apidoc.element.pmx.catchAll">
        function <span class="apidocSignatureSpan">pmx.</span>catchAll
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">catchAll = function (opts) {

  var callsites = require('./utils/error-callsites')

  if (opts === undefined)
    opts = { errors : true };

  Options.configureModule({
    error : opts.errors
  });

  if (process.env.exec_mode === 'cluster_mode')
    return false;

  function getUncaughtExceptionListener(listener) {
    return function uncaughtListener(err) {
      var error = err &amp;&amp; err.stack ? err.stack : err;

      if (err &amp;&amp; err.length) {
        err._length = err.length;
        delete err.length;
      }

      if (listener === 'unhandledRejection') {
        error = 'You have triggered an unhandledRejection, you may have forgotten to catch a Promise rejection:\n' + error;
      }

      console.error(error);
      if (err)
        var errObj = Notify._interpretError(err);

      Transport.send({
        type : 'process:exception',
        data : errObj !== undefined ? errObj : {message: 'No error but ' + listener + ' was caught!' }
      }, true);

      if (!process.listeners(listener).filter(function (listener) {
        return listener !== uncaughtListener;
      }).length) {

        if (listener == 'uncaughtException')
          process.exit(1);
      }
    }
  }

  if (opts.errors === true &amp;&amp; util.inspect(process.listeners('uncaughtException')).length === 2) {
    process.once('uncaughtException', getUncaughtExceptionListener('uncaughtException'));
    process.once('unhandledRejection', getUncaughtExceptionListener('unhandledRejection'));
  }
  else if (opts.errors === false
           &amp;&amp; util.inspect(process.listeners('uncaughtException')).length !== 2) {
    process.removeAllListeners('uncaughtException');
    process.removeAllListeners('unhandledRejection');
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  PMX.catchTraffic();

if (opts.transactions)
  PMX.tracing(PMX, opts);
if (opts.http)
  PMX.http(opts);

PMX.<span class="apidocCodeKeywordSpan">catchAll</span>(opts);

if (opts.profiling)
  Profiling.v8Profiling(PMX);

if (opts.custom_probes == true) {
  // Event loop monitoring
  require('./probes/pacemaker.js')(PMX);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.catchPorts" id="apidoc.element.pmx.catchPorts">
        function <span class="apidocSignatureSpan">pmx.</span>catchPorts
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">catchPorts = function () {
  var ports_list = [];
  var opened_ports = 'N/A';

  Probe.probe().metric({
    name    : 'Open ports',
    value   : function() { return opened_ports; }
  });

  var original_listen = net_module.Server.prototype.listen;

  net_module.Server.prototype.listen = function() {
    var port = parseInt(arguments[0]);

    if (!isNaN(port) &amp;&amp; ports_list.indexOf(port) === -1) {
      ports_list.push(port);
      opened_ports = ports_list.sort().join();
    }

    this.once('close', function() {
      if (ports_list.indexOf(port) &gt; -1) {
        ports_list.splice(ports_list.indexOf(port), 1);
        opened_ports = ports_list.sort().join();
      }
    });

    return original_listen.apply(this, arguments);
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  excludedHooks: []
}, opts);

opts = Configuration.init(opts);
this._pmx_conf = opts;

if (opts.ports)
  PMX.<span class="apidocCodeKeywordSpan">catchPorts</span>();
if (opts.network)
  PMX.catchTraffic();

if (opts.transactions)
  PMX.tracing(PMX, opts);
if (opts.http)
  PMX.http(opts);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.catchTraffic" id="apidoc.element.pmx.catchTraffic">
        function <span class="apidocSignatureSpan">pmx.</span>catchTraffic
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">catchTraffic = function () {
  var download = 0;
  var upload   = 0;
  var up       = '0 B/sec';
  var down     = '0 B/sec';

  var filter = function(bytes) {
    var to_fixed = 0;

    if (bytes === 0)
      ;
    else if (bytes &lt; 1024)
      to_fixed = 6;
    else if (bytes &lt; (1024 * 1024))
      to_fixed = 3;
    else
      to_fixed = 2;

    bytes = (bytes / (1024 * 1024)).toFixed(to_fixed);

    var cut_zeros = 0;

    for (var i = (bytes.length - 1); i &gt; 0; --i) {
      if (bytes[i] === '.') {
        ++cut_zeros;
        break;
      }
      if (bytes[i] !== '0')
        break;
      ++cut_zeros;
    }

    if (cut_zeros &gt; 0)
      bytes = bytes.slice(0, -(cut_zeros));

    return (bytes + ' MB/s');
  };

  var interval = setInterval(function() {
    up = filter(upload);
    down = filter(download);
    upload = 0;
    download = 0;
  }, 999);

  interval.unref();

  Probe.probe().metric({
    name     : 'Network Download',
    agg_type : 'sum',
    value    : function() { return down; }
  });

  Probe.probe().metric({
    name     : 'Network Upload',
    agg_type : 'sum',
    value    : function() { return up; }
  });

  var original_write = net_module.Socket.prototype.write;

  net_module.Socket.prototype.write = function(data) {
    if (data.length)
      upload += data.length;
    return original_write.apply(this, arguments);
  };

  var original_read = net_module.Socket.prototype.read;

  net_module.Socket.prototype.read = function() {

    if (!this.monitored) {
      this.monitored = true;

      this.on('data', function(data) {
        if (data.length)
          download += data.length;
      });
    }

    return original_read.apply(this, arguments);
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

opts = Configuration.init(opts);
this._pmx_conf = opts;

if (opts.ports)
  PMX.catchPorts();
if (opts.network)
  PMX.<span class="apidocCodeKeywordSpan">catchTraffic</span>();

if (opts.transactions)
  PMX.tracing(PMX, opts);
if (opts.http)
  PMX.http(opts);

PMX.catchAll(opts);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.configureModule" id="apidoc.element.pmx.configureModule">
        function <span class="apidocSignatureSpan">pmx.</span>configureModule
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">configureModule = function (opts) {
  Transport.send({
    type : 'axm:option:configuration',
    data : opts
  }, false);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
} catch(e) {
  //console.error(e);
  //console.error('Error while parsing configuration in environment (%s)', conf.module_name);
}

if (do_not_tell_pm2 == true) return conf;

Options.<span class="apidocCodeKeywordSpan">configureModule</span>(conf);
return conf;
};

Options.getPID = function(file) {
if (typeof(file) === 'number')
  return file;
return parseInt(fs.readFileSync(file).toString());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.datachecker" id="apidoc.element.pmx.datachecker">
        function <span class="apidocSignatureSpan">pmx.</span>datachecker
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function dataChecker(opts) {
  var self = this;
  this._counter = 0;

  opts = opts || {};

  if (typeof(opts.refresh) !== 'function')
    throw new Error('Refresh not defined or not a function');

  this._refresh = opts.refresh;

  this._monitored = false;
  this._launch = opts.launch || 10000;
  this._ceil = opts.ceil || 5;
  this._timer = opts.timer || 1000;
  this._dev   = opts.dev || 0.2;
  this._callback = opts.callback || null;
  this._histogram = new Histogram();
  this._calcDev = opts.calcDev || 'ema';

<span class="apidocCodeCommentSpan">  /*
   * Select function to compute deviation
   */
</span>  var func = {
    ema    : this.normalDev,
    mean   : this.medianDev
  }
  this.computeDev = func[this._calcDev];

  /**
   * Display some probe if we need to debug
   */
  if (opts.debug === true) {
    if (opts.probes.indexOf('val') != -1) {
      this._metric2 = new probe.metric({
        name  : 'Value',
        value : function() {
          return self._refresh();
        }
      });
    }
    if (opts.probes.indexOf('ema') != -1) {
      this._metric3 = new probe.metric({
        name  : 'EMA',
        value : function() {
          return self._histogram.getEma();
        }
      });
    }
  }
  /**
    * Delay before monitoring starts
    */
  setTimeout(function() {
    self._monitored = true;
  }, this._launch);
  this.start();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.detectV8Profiler" id="apidoc.element.pmx.detectV8Profiler">
        function <span class="apidocSignatureSpan">pmx.</span>detectV8Profiler
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">detectV8Profiler = function (cb) {
  var require_paths = require.main.paths.slice();

  (function look_for_profiler(require_paths) {
    if (!require_paths[0])
      return cb(new Error('Module not found'));

    var profiler_path = path.join(require_paths[0], 'v8-profiler');

    fs.exists(profiler_path, function(exist) {
      if (exist)
        return cb(null, profiler_path);

      require_paths.shift();
      return look_for_profiler(require_paths);
    });
    return false;
  })(require_paths);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      return look_for_profiler(require_paths);
    });
    return false;
  })(require_paths);
};

Profiling.v8Profiling = function(pmx) {
  Profiling.<span class="apidocCodeKeywordSpan">detectV8Profiler</span>(function(err, profiler_path) {
    if (err)
      return false;
    return Profiling.exposeProfiling(pmx, profiler_path);
  });
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.emit" id="apidoc.element.pmx.emit">
        function <span class="apidocSignatureSpan">pmx.</span>emit
        <span class="apidocSignatureSpan">(name, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">emit = function (name, data) {
  if (!name)
    return console.error('[AXM] emit.name is missing');
  if (!data)
    return console.error('[AXM] emit.data is missing');

  var inflight_obj = {};

  if (typeof(data) == 'object')
    inflight_obj = JSON.parse(stringify(data));
  else {
    inflight_obj.data = data;
  }

  inflight_obj.__name = name;

  Transport.send({
    type : 'human:event',
    data : inflight_obj
  }, true);
  return false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Emit events and get historical and statistics.
This is available in the **Events** page of Keymetrics.

```javascript
var pmx = require('pmx');

pmx.<span class="apidocCodeKeywordSpan">emit</span>('user:register', {
  user : 'Alex registered',
  email : 'thorustor@gmail.com'
});
```

## Application level network traffic monitoring / Display used ports
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.enableProbe" id="apidoc.element.pmx.enableProbe">
        function <span class="apidocSignatureSpan">pmx.</span>enableProbe
        <span class="apidocSignatureSpan">(custom_namespace)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function enableProbes(custom_namespace) {
  if (!custom_namespace)
    custom_namespace = 'axm';

  if (!global[custom_namespace])
    global[custom_namespace] = {};

  if (this.interval)
    return global[custom_namespace];

  this.interval = setInterval(function() {
    Transport.send({
      type : 'axm:monitor',
      data : cookData(global[custom_namespace])
    });
  }, 990);

  this.interval.unref();

  return global[custom_namespace];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.enableProbes" id="apidoc.element.pmx.enableProbes">
        function <span class="apidocSignatureSpan">pmx.</span>enableProbes
        <span class="apidocSignatureSpan">(custom_namespace)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function enableProbes(custom_namespace) {
  if (!custom_namespace)
    custom_namespace = 'axm';

  if (!global[custom_namespace])
    global[custom_namespace] = {};

  if (this.interval)
    return global[custom_namespace];

  this.interval = setInterval(function() {
    Transport.send({
      type : 'axm:monitor',
      data : cookData(global[custom_namespace])
    });
  }, 990);

  this.interval.unref();

  return global[custom_namespace];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.exposeProfiling" id="apidoc.element.pmx.exposeProfiling">
        function <span class="apidocSignatureSpan">pmx.</span>exposeProfiling
        <span class="apidocSignatureSpan">(pmx, profiler_path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">exposeProfiling = function (pmx, profiler_path) {
  try {
    var profiler = require(profiler_path);
  } catch(e) {
    debug('v8-profiler module not installed', e);
    return false;
  }

  debug('v8-profiler sucessfully enabled');

<span class="apidocCodeCommentSpan">  /**
   * Tell Keymetrics that profiling is possible
   * (flag available in axm_options object)
   */
</span>  Options.configureModule({
    heapdump : true
  });

  /**
   * Heap snapshot
   */
  pmx.action('km:heapdump', function(reply) {
    var dump_file = path.join(os.tmpDir(), Date.now() + '.heapsnapshot');

    var snapshot = profiler.takeSnapshot('km-heap-snapshot');
    var buffer    = '';

    snapshot.serialize(
      function iterator(data, length) {
        buffer += data;
      }, function complete() {
        snapshot.delete();

        fs.writeFile(dump_file, buffer, function (err) {
          debug('Heap dump file flushed (e=', err);

          if (err) {
            return reply({
              success   : false,
              err : err
            });
          }
          return reply({
            success   : true,
            heapdump  : true,
            dump_file : dump_file
          });
        });
      }
    );
  });

  /**
   * CPU profiling snapshot
   */
  var ns_cpu_profiling        = 'km-cpu-profiling';
  var cpu_dump_file = path.join(os.tmpDir(), Date.now() + '.cpuprofile');

  pmx.action('km:cpu:profiling:start', function(reply) {
    profiler.startProfiling(ns_cpu_profiling);
    return reply({ success : true });
  });

  pmx.action('km:cpu:profiling:stop', function(reply) {
    var cpu = profiler.stopProfiling(ns_cpu_profiling);

    fs.writeFile(cpu_dump_file, JSON.stringify(cpu), function(err) {
      if (err) {
        return reply({
          success   : false,
          err : err
        });
      }
      return reply({
        success     : true,
        cpuprofile  : true,
        dump_file   : cpu_dump_file
      });
    });
  });

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  })(require_paths);
};

Profiling.v8Profiling = function(pmx) {
  Profiling.detectV8Profiler(function(err, profiler_path) {
    if (err)
      return false;
    return Profiling.<span class="apidocCodeKeywordSpan">exposeProfiling</span>(pmx, profiler_path);
  });
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.expressErrorHandler" id="apidoc.element.pmx.expressErrorHandler">
        function <span class="apidocSignatureSpan">pmx.</span>expressErrorHandler
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">expressErrorHandler = function () {
  var self = this;

  Options.configureModule({
    error : true
  });

  return function errorHandler(err, req, res, next) {
    if (res.statusCode &lt; 400) res.statusCode = 500;

    //debug(err.stack || err);

    err.url = req.url;
    err.component = req.url;
    err.action = req.method;
    err.params = req.body;
    err.session = req.session;

    Transport.send({
      type  : 'process:exception',
      data  : jsonize(err)
    }, true);
    return next(err);
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// All my routes
app.get('/' ...);
app.post(...);
// All my routes

// Here I attach the middleware to get more verbosity on exception thrown
app.use(pmx.<span class="apidocCodeKeywordSpan">expressErrorHandler</span>());
```

## Emit Events

Emit events and get historical and statistics.
This is available in the **Events** page of Keymetrics.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.getConf" id="apidoc.element.pmx.getConf">
        function <span class="apidocSignatureSpan">pmx.</span>getConf
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getConf = function () {
  return this._pmx_conf;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  Probe._var[opts.name].alert = new Alert(alert_opts, {name : opts.name});
}
}

Probe.probe = function() {
var self = this;
// Get module configuration to enable alerts
if (this.getConf &amp;&amp; this.<span class="apidocCodeKeywordSpan">getConf</span>())
  Probe._alert_activated = this.getConf().alert_enabled || true;
else
  Probe._alert_activated = false;

if (Probe._started == false) {
  Probe._started = true;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.getEnv" id="apidoc.element.pmx.getEnv">
        function <span class="apidocSignatureSpan">pmx.</span>getEnv
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getEnv = function () {
  return process.env;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.getPID" id="apidoc.element.pmx.getPID">
        function <span class="apidocSignatureSpan">pmx.</span>getPID
        <span class="apidocSignatureSpan">(file)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getPID = function (file) {
  if (typeof(file) === 'number')
    return file;
  return parseInt(fs.readFileSync(file).toString());
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.http" id="apidoc.element.pmx.http">
        function <span class="apidocSignatureSpan">pmx.</span>http
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">http = function (opts) {
  var Module = require('module');

  debug('Wrapping HTTP routes');

  if (Array.isArray(opts)) {
    var routes = JSON.parse(JSON.stringify(opts));
    opts = {
      http          : true,
      http_latency  : 200,
      http_code     : 500,
      ignore_routes : routes
    };
  }
  opts = util._extend({
    http          : true,
    http_latency  : 200,
    http_code     : 500,
    ignore_routes : []
  }, opts);

  Proxy.wrap(Module, '_load', function(load) {
    if (load.__axm_original) {
      debug('HTTP routes have already been wrapped before');

      Options.configureModule({
        latency : opts.http
      });

      if (opts.http === false) {
        return function(file) { return load.__axm_original.apply(this, arguments) };
      } else {
        return function(file) {
          if (file === 'http' || file === 'https')
            return SimpleHttpWrap(opts, load.__axm_original.apply(this, arguments));
          else
            return load.__axm_original.apply(this, arguments);
        };
      }
    }

    return function(file) {
      if (opts.http &amp;&amp;
          (file === 'http' || file === 'https')) {
        debug('http module being required');
        Options.configureModule({
          latency : true
        });
        return SimpleHttpWrap(opts, load.apply(this, arguments));
      }
      else
        return load.apply(this, arguments);
    };
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  PMX.catchPorts();
if (opts.network)
  PMX.catchTraffic();

if (opts.transactions)
  PMX.tracing(PMX, opts);
if (opts.http)
  PMX.<span class="apidocCodeKeywordSpan">http</span>(opts);

PMX.catchAll(opts);

if (opts.profiling)
  Profiling.v8Profiling(PMX);

if (opts.custom_probes == true) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.init" id="apidoc.element.pmx.init">
        function <span class="apidocSignatureSpan">pmx.</span>init
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (opts) {
  if (!opts) opts = {};

  opts = util._extend({
    default_actions : true,
    transactions  : false,
    http          : true,
    http_latency  : 200,
    http_code     : 500,
    ignore_routes : [],
    profiling     : true,
    errors        : true,
    // By default if you add alert subfield in custom
    // it's going to be enabled
    alert_enabled : true,
    custom_probes : true,
    network       : false,
    ports         : false,

    // VXX options
    // ignoreFilter.url is aliased to ignore_routes
    ignoreFilter: {
      'url': [],
      'method': ['OPTIONS']
    },
    // 'express', 'hapi', 'http', 'restify'
    excludedHooks: []
  }, opts);

  opts = Configuration.init(opts);
  this._pmx_conf = opts;

  if (opts.ports)
    PMX.catchPorts();
  if (opts.network)
    PMX.catchTraffic();

  if (opts.transactions)
    PMX.tracing(PMX, opts);
  if (opts.http)
    PMX.http(opts);

  PMX.catchAll(opts);

  if (opts.profiling)
    Profiling.v8Profiling(PMX);

  if (opts.custom_probes == true) {
    // Event loop monitoring
    require('./probes/pacemaker.js')(PMX);
  }

  if (opts.default_actions == true) {
    //require('./actions/default.js')(PMX);
  }

  opts.isModule = false;
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
You can monitor the network usage of a specific application by adding the option `network: true` when initializing PMX. If you enable
 the flag `ports: true` when you init pmx it will show which ports your app is listenting on.

These metrics will be shown in the Keymetrics Dashboard in the Custom Metrics section.

Example:

```javascript
pmx.<span class="apidocCodeKeywordSpan">init</span>({
  [...]
  network : true, // Allow application level network monitoring
  ports   : true  // Display ports used by the application
});
```

## Advanced PMX configuration
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.initModule" id="apidoc.element.pmx.initModule">
        function <span class="apidocSignatureSpan">pmx.</span>initModule
        <span class="apidocSignatureSpan">(opts, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">initModule = function (opts, cb) {
  if (!opts) opts = {};

  opts = util._extend({
    alert_enabled    : true,
    widget           : {}
  }, opts);

  opts.widget = util._extend({
    type : 'generic',
    logo : 'https://app.keymetrics.io/img/logo/keymetrics-300.png',
    theme            : ['#111111', '#1B2228', '#807C7C', '#807C7C']
  }, opts.widget);

  opts.isModule = true;
  opts = Configuration.init(opts);

  // Force error catching
  PMX.catchAll();

  this._pmx_conf = opts;

  if (cb &amp;&amp; typeof(cb) == 'function')
    return cb(null, opts);

  return opts;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.notify" id="apidoc.element.pmx.notify">
        function <span class="apidocSignatureSpan">pmx.</span>notify
        <span class="apidocSignatureSpan">(err)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">notify = function (err) {
  var ret_err = this._interpretError(err);

  // full_err
  //debug(ret_err);

  Transport.send({
    type : 'process:exception',
    data : ret_err
  }, true);

  return ret_err;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
### Custom alert notification

If you need to alert about any critical errors you can do it programmatically:

```javascript
var pmx = require('pmx');

pmx.<span class="apidocCodeKeywordSpan">notify</span>({ success : false });

pmx.notify('This is an error');

pmx.notify(new Error('This is an error'));
```

### Add Verbosity to an Alert: Express Error handler
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.probe" id="apidoc.element.pmx.probe">
        function <span class="apidocSignatureSpan">pmx.</span>probe
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">probe = function () {
  var self = this;
  // Get module configuration to enable alerts
  if (this.getConf &amp;&amp; this.getConf())
    Probe._alert_activated = this.getConf().alert_enabled || true;
  else
    Probe._alert_activated = false;

  if (Probe._started == false) {
    Probe._started = true;

    var p_interval = setInterval(function() {
      Transport.send({
        type : 'axm:monitor',
        data : cookData(Probe._var)
      });
      checkIssues(Probe._var);
    }, 990);

    p_interval.unref();
  }

  return {
<span class="apidocCodeCommentSpan">    /**
     * This reflect data to keymetrics
     * pmx.transpose('prop name', fn)
     *
     * or
     *
     * pmx.transpose({
     *   name : 'variable name',
     *   data : function() { return value }
     * });
     */
</span>    transpose : function(variable_name, reporter) {
      if (typeof variable_name === 'object') {
        reporter = variable_name.data;
        variable_name = variable_name.name;
      }

      if (typeof reporter !== 'function') {
        return console.error('[PMX] reporter is not a function');
      }

      Probe._var[variable_name] = {
        value: reporter
      };
    },
    metric : function(opts) {
      var agg_type = opts.agg_type || Probe.default_aggregation;

      if (!opts.name)
        return console.error('[Probe][Metric] Name not defined');
      if (Probe.AVAILABLE_AGG_TYPES.indexOf(agg_type) == -1)
        return console.error("[Probe][Metric] Unknown agg_type: %s", agg_type);

      Probe._var[opts.name] = {
        value   : opts.value || 0,
        agg_type: agg_type
      };

      /**
       * Attach alert to: Probe._var[opts.name].alert
       */
      if (self.getConf)
        attachAlert(opts, self.getConf());

      return {
        val : function() {
          var value = Probe._var[opts.name].value;

          if (typeof(value) == 'function')
            value = value();

          return value;
        },
        set : function(dt) {
          Probe._var[opts.name].value = dt;
        }
      };
    },
    histogram : function(opts) {
      if (!opts.name)
        return console.error('[Probe][Histogram] Name not defined');
      opts.measurement = opts.measurement || 'mean';
      opts.unit = opts.unit || '';
      var agg_type = opts.agg_type || Probe.default_aggregation;

      if (Probe.AVAILABLE_MEASUREMENTS.indexOf(opts.measurement) == -1)
        return console.error('[Probe][Histogram] Measure type %s does not exists', opts.measurement);
      if (Probe.AVAILABLE_AGG_TYPES.indexOf(agg_type) == -1)
        return console.error("[Probe][Metric] Unknown agg_type: %s", agg_type);

      var histogram = new Histogram(opts);

      Probe._var[opts.name] = {
        value: function() { return (Math.round(histogram.val() * 100) / 100) + '' + opts.unit },
        agg_type: agg_type
      };

      /**
       * Attach alert to: Probe._var[opts.name].alert
       */
      if (self.getConf)
        attachAlert(opts, self.getConf());

      return histogram;
    },
    meter : function(opts) {
      var agg_type = opts.agg_type || Probe.default_aggregation;

      if (!opts.name)
        return console.error('[Probe][Meter] Name not defined');
      if (Probe.AVAILABLE_AGG_TYPES.indexOf(agg_type) == -1)
        return console.error("[Probe][Metric] Unknown agg_type: %s", agg_type);

      opts.unit = opts.unit || '';

      var meter = new Meter(opts);

      Probe._var[opts.name] = {
        value: function() { return meter.val() + '' + opts.unit },
        agg_type: agg_type
      };

      /**
       * Attach alert to: Probe._var[opts.name].alert
       */
      if (self.getConf)
        attachAlert(opts, self.getConf());

      return meter;
    },
    counter : function(opts) {
      var agg_type = opts.agg_type || Probe.default_aggregation;

      if (!opts.name)
        return console.error('[Probe][Counter] Name not defined');
      if (Probe.AVAILABLE_AGG_TYPES.indexOf(agg_type) == -1)
        return console.error("[Probe][Metric] Unknown agg_type: %s", agg_type);

      var counter = new Counter();

      Probe._var[opts.name] = {
        value: ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  - eg. Monitor the mean of execution of a query into database

### Metric: Simple value reporting

This allow to expose values that can be read instantly.

```javascript
var probe = pmx.<span class="apidocCodeKeywordSpan">probe</span>();

// Here the value function will be called each second to get the value
// returned by Object.keys(users).length
var metric = probe.metric({
name    : 'Realtime user',
value   : function() {
  return Object.keys(users).length;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.resolvePidPaths" id="apidoc.element.pmx.resolvePidPaths">
        function <span class="apidocSignatureSpan">pmx.</span>resolvePidPaths
        <span class="apidocSignatureSpan">(filepaths)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">resolvePidPaths = function (filepaths) {
  if (typeof(filepaths) === 'number')
    return filepaths;

  function detect(filepaths) {
    var content = '';

    filepaths.some(function(filepath) {
      try {
        content = fs.readFileSync(filepath);
      } catch(e) {
        return false;
      }
      return true;
    });

    return content.toString().trim();
  }

  var ret = parseInt(detect(filepaths));

  return isNaN(ret) ? null : ret;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.sample" id="apidoc.element.pmx.sample">
        function <span class="apidocSignatureSpan">pmx.</span>sample
        <span class="apidocSignatureSpan">(size)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sample = function (size) {
  this._elements = [];
  this._size = size || 300;
  this._sum = 0;
  this._count = 0;
  this._varianceM = 0;
  this._varianceS = 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.scopedAction" id="apidoc.element.pmx.scopedAction">
        function <span class="apidocSignatureSpan">pmx.</span>scopedAction
        <span class="apidocSignatureSpan">(action_name, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">scopedAction = function (action_name, fn) {

  if (!action_name)
    return console.error('[PMX] action.action_name is missing');
  if (!fn)
    return console.error('[PMX] callback is missing');

  if (!process.send) {
    debug('Process not running within PM2');
    return false;
  }

  // Notify the action
  Transport.send({
    type : 'axm:action',
    data : {
      action_name : action_name,
      action_type : 'scoped'
    }
  });

  process.on('message', function(data) {
    if (!data
        || data.uuid === undefined
        || data.action_name === undefined)
      return false;

    if (data.action_name === action_name) {
      var res = {
        send : function(dt) {
          Transport.send({
            type        : 'axm:scoped_action:stream',
            data        : {
              data        : dt,
              uuid        : data.uuid,
              action_name : action_name
            }
          });
        },
        error : function(dt) {
          Transport.send({
            type        : 'axm:scoped_action:error',
            data        : {
              data        : dt,
              uuid        : data.uuid,
              action_name : action_name
            }
          });
        },
        end : function(dt) {
          Transport.send({
            type        : 'axm:scoped_action:end',
            data        : {
              data        : dt,
              uuid        : data.uuid,
              action_name : action_name
            }
          });
        }
      };

      var d = domain.create();

      d.on('error', function(err) {
        res.error(err.message || err.stack || err);
        setTimeout(function() {
          process.exit(1);
        }, 300);
      });

      d.run(function() {
        fn(data.opts || null, res);
      });
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Scoped Actions are advanced remote actions that can be also triggered from Keymetrics.

Two arguments are passed to the function, data (optional data sent from Keymetrics) and res that allows to emit log data and to
end the scoped action.

Example:

```javascript
pmx.<span class="apidocCodeKeywordSpan">scopedAction</span>('long running lsof', function(data, res) {
var child = spawn('lsof', []);

child.stdout.on('data', function(chunk) {
  chunk.toString().split('\n').forEach(function(line) {
    res.send(line); // This send log to Keymetrics to be saved (for tracking)
  });
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.stopProbe" id="apidoc.element.pmx.stopProbe">
        function <span class="apidocSignatureSpan">pmx.</span>stopProbe
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function stopProbing() {
  clearInterval(this.interval);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.stopProbes" id="apidoc.element.pmx.stopProbes">
        function <span class="apidocSignatureSpan">pmx.</span>stopProbes
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function stopProbing() {
  clearInterval(this.interval);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.tracing" id="apidoc.element.pmx.tracing">
        function <span class="apidocSignatureSpan">pmx.</span>tracing
        <span class="apidocSignatureSpan">(pmx, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tracing = function (pmx, opts) {

  if (Array.isArray(opts.ignore_routes) &amp;&amp; opts.ignore_routes.length &gt; 0) {
    opts.ignoreFilter.url = opts.ignore_routes;
  }

  Transaction.tracer = require('vxx').start(opts);

  Options.configureModule({
    tracing_enabled : true
  });

  // broadcast to pm2 aggregator
  Transaction.tracer.getBus().on('transaction', function(data) {
    Transport.send({
      type: 'axm:trace',
      data: data
    })
  })

  // Transaction.tracer.getBus().on('transaction', function (data) {
  //   if (!opts.custom_probes) return;
  //   // TODO: mine tracing data and require custom probes
  //<span class="apidocCodeCommentSpan">   /*try {
  //     var custom_probe = require('./probes/' + modul)(pmx, Transaction.tracer)
  //   } catch (err) { }*/
</span>  // })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

if (opts.ports)
  PMX.catchPorts();
if (opts.network)
  PMX.catchTraffic();

if (opts.transactions)
  PMX.<span class="apidocCodeKeywordSpan">tracing</span>(PMX, opts);
if (opts.http)
  PMX.http(opts);

PMX.catchAll(opts);

if (opts.profiling)
  Profiling.v8Profiling(PMX);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.v8Profiling" id="apidoc.element.pmx.v8Profiling">
        function <span class="apidocSignatureSpan">pmx.</span>v8Profiling
        <span class="apidocSignatureSpan">(pmx)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">v8Profiling = function (pmx) {
  Profiling.detectV8Profiler(function(err, profiler_path) {
    if (err)
      return false;
    return Profiling.exposeProfiling(pmx, profiler_path);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  PMX.tracing(PMX, opts);
if (opts.http)
  PMX.http(opts);

PMX.catchAll(opts);

if (opts.profiling)
  Profiling.<span class="apidocCodeKeywordSpan">v8Profiling</span>(PMX);

if (opts.custom_probes == true) {
  // Event loop monitoring
  require('./probes/pacemaker.js')(PMX);
}

if (opts.default_actions == true) {
...</pre></li>
    </ul>
















































</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.BinaryHeap" id="apidoc.module.pmx.BinaryHeap">module pmx.BinaryHeap</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.BinaryHeap.BinaryHeap" id="apidoc.element.pmx.BinaryHeap.BinaryHeap">
        function <span class="apidocSignatureSpan">pmx.</span>BinaryHeap
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function BinaryHeap(options) {
  options = options || {};

  this._elements = options.elements || [];
  this._score    = options.score || this._score;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.BinaryHeap.prototype" id="apidoc.module.pmx.BinaryHeap.prototype">module pmx.BinaryHeap.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.BinaryHeap.prototype._bubble" id="apidoc.element.pmx.BinaryHeap.prototype._bubble">
        function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>_bubble
        <span class="apidocSignatureSpan">(bubbleIndex)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_bubble = function (bubbleIndex) {
  var bubbleElement = this._elements[bubbleIndex];
  var bubbleScore   = this._score(bubbleElement);

  while (bubbleIndex &gt; 0) {
    var parentIndex   = this._parentIndex(bubbleIndex);
    var parentElement = this._elements[parentIndex];
    var parentScore   = this._score(parentElement);

    if (bubbleScore &lt;= parentScore) break;

    this._elements[parentIndex] = bubbleElement;
    this._elements[bubbleIndex]  = parentElement;
    bubbleIndex                  = parentIndex;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

BinaryHeap.prototype.add = function(/* elements */) {
  for (var i = 0; i &lt; arguments.length; i++) {
    var element = arguments[i];

    this._elements.push(element);
    this.<span class="apidocCodeKeywordSpan">_bubble</span>(this._elements.length - 1);
  }
};

BinaryHeap.prototype.first = function() {
  return this._elements[0];
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.BinaryHeap.prototype._childIndexes" id="apidoc.element.pmx.BinaryHeap.prototype._childIndexes">
        function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>_childIndexes
        <span class="apidocSignatureSpan">(index)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_childIndexes = function (index) {
  return [
    2 * index + 1,
    2 * index + 2,
  ];
  return ;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  var sinkScore   = this._score(sinkElement);
  var length      = this._elements.length;

  while (true) {
    var swapIndex    = null;
    var swapScore    = null;
    var swapElement  = null;
    var childIndexes = this.<span class="apidocCodeKeywordSpan">_childIndexes</span>(sinkIndex);

    for (var i = 0; i &lt; childIndexes.length; i++) {
var childIndex   = childIndexes[i];

if (childIndex &gt;= length) break;

var childElement = this._elements[childIndex];
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.BinaryHeap.prototype._parentIndex" id="apidoc.element.pmx.BinaryHeap.prototype._parentIndex">
        function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>_parentIndex
        <span class="apidocSignatureSpan">(index)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_parentIndex = function (index) {
  return Math.floor((index - 1) / 2);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

BinaryHeap.prototype._bubble = function(bubbleIndex) {
  var bubbleElement = this._elements[bubbleIndex];
  var bubbleScore   = this._score(bubbleElement);

  while (bubbleIndex &gt; 0) {
var parentIndex   = this.<span class="apidocCodeKeywordSpan">_parentIndex</span>(bubbleIndex);
var parentElement = this._elements[parentIndex];
var parentScore   = this._score(parentElement);

if (bubbleScore &lt;= parentScore) break;

this._elements[parentIndex] = bubbleElement;
this._elements[bubbleIndex]  = parentElement;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.BinaryHeap.prototype._score" id="apidoc.element.pmx.BinaryHeap.prototype._score">
        function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>_score
        <span class="apidocSignatureSpan">(element)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_score = function (element) {
  return element.valueOf();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

BinaryHeap.prototype.size = function() {
  return this._elements.length;
};

BinaryHeap.prototype._bubble = function(bubbleIndex) {
  var bubbleElement = this._elements[bubbleIndex];
  var bubbleScore   = this.<span class="apidocCodeKeywordSpan">_score</span>(bubbleElement);

  while (bubbleIndex &gt; 0) {
var parentIndex   = this._parentIndex(bubbleIndex);
var parentElement = this._elements[parentIndex];
var parentScore   = this._score(parentElement);

if (bubbleScore &lt;= parentScore) break;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.BinaryHeap.prototype._sink" id="apidoc.element.pmx.BinaryHeap.prototype._sink">
        function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>_sink
        <span class="apidocSignatureSpan">(sinkIndex)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_sink = function (sinkIndex) {
  var sinkElement = this._elements[sinkIndex];
  var sinkScore   = this._score(sinkElement);
  var length      = this._elements.length;

  while (true) {
    var swapIndex    = null;
    var swapScore    = null;
    var swapElement  = null;
    var childIndexes = this._childIndexes(sinkIndex);

    for (var i = 0; i &lt; childIndexes.length; i++) {
      var childIndex   = childIndexes[i];

      if (childIndex &gt;= length) break;

      var childElement = this._elements[childIndex];
      var childScore   = this._score(childElement);

      if (childScore &gt; sinkScore) {
        if (swapScore === null || swapScore &lt; childScore) {
          swapIndex   = childIndex;
          swapScore   = childScore;
          swapElement = childElement;
        }
      }
    }

    if (swapIndex === null) break;

    this._elements[swapIndex] = sinkElement;
    this._elements[sinkIndex] = swapElement;
    sinkIndex = swapIndex;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

BinaryHeap.prototype.removeFirst = function() {
var root = this._elements[0];
var last = this._elements.pop();

if (this._elements.length &gt; 0) {
  this._elements[0] = last;
  this.<span class="apidocCodeKeywordSpan">_sink</span>(0);
}

return root;
};

BinaryHeap.prototype.clone = function() {
return new BinaryHeap({
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.BinaryHeap.prototype.add" id="apidoc.element.pmx.BinaryHeap.prototype.add">
        function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>add
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">add = function () {
  for (var i = 0; i &lt; arguments.length; i++) {
    var element = arguments[i];

    this._elements.push(element);
    this._bubble(this._elements.length - 1);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  var element = {
    priority: this._priority(timestamp - this._landmark),
    value: value
  };

  if (newSize &lt;= this._size) {
    this._elements.<span class="apidocCodeKeywordSpan">add</span>(element);
  } else if (element.priority &gt; this._elements.first().priority) {
    this._elements.removeFirst();
    this._elements.add(element);
  }

  if (now &gt;= this._nextRescale) this._rescale(now);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.BinaryHeap.prototype.clone" id="apidoc.element.pmx.BinaryHeap.prototype.clone">
        function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>clone
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">clone = function () {
  return new BinaryHeap({
    elements: this.toArray(),
    score: this._score,
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  elements: this.toArray(),
  score: this._score,
});
};

BinaryHeap.prototype.toSortedArray = function() {
var array = [];
var clone = this.<span class="apidocCodeKeywordSpan">clone</span>();

while (true) {
  var element = clone.removeFirst();
  if (element === undefined) break;

  array.push(element);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.BinaryHeap.prototype.first" id="apidoc.element.pmx.BinaryHeap.prototype.first">
        function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>first
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">first = function () {
  return this._elements[0];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  var element = {
    priority: this._priority(timestamp - this._landmark),
    value: value
  };

  if (newSize &lt;= this._size) {
    this._elements.add(element);
  } else if (element.priority &gt; this._elements.<span class="apidocCodeKeywordSpan">first</span>().priority) {
    this._elements.removeFirst();
    this._elements.add(element);
  }

  if (now &gt;= this._nextRescale) this._rescale(now);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.BinaryHeap.prototype.removeFirst" id="apidoc.element.pmx.BinaryHeap.prototype.removeFirst">
        function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>removeFirst
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">removeFirst = function () {
  var root = this._elements[0];
  var last = this._elements.pop();

  if (this._elements.length &gt; 0) {
    this._elements[0] = last;
    this._sink(0);
  }

  return root;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

BinaryHeap.prototype.toSortedArray = function() {
  var array = [];
  var clone = this.clone();

  while (true) {
    var element = clone.<span class="apidocCodeKeywordSpan">removeFirst</span>();
    if (element === undefined) break;

    array.push(element);
  }

  return array;
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.BinaryHeap.prototype.size" id="apidoc.element.pmx.BinaryHeap.prototype.size">
        function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>size
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">size = function () {
  return this._elements.length;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (!this._landmark) {
  this._landmark    = now;
  this._nextRescale = this._landmark + this._rescaleInterval;
}

timestamp = timestamp || now;

var newSize = this._elements.<span class="apidocCodeKeywordSpan">size</span>() + 1;

var element = {
  priority: this._priority(timestamp - this._landmark),
  value: value
};

if (newSize &lt;= this._size) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.BinaryHeap.prototype.toArray" id="apidoc.element.pmx.BinaryHeap.prototype.toArray">
        function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>toArray
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toArray = function () {
  return [].concat(this._elements);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

return root;
};

BinaryHeap.prototype.clone = function() {
return new BinaryHeap({
  elements: this.<span class="apidocCodeKeywordSpan">toArray</span>(),
  score: this._score,
});
};

BinaryHeap.prototype.toSortedArray = function() {
var array = [];
var clone = this.clone();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.BinaryHeap.prototype.toSortedArray" id="apidoc.element.pmx.BinaryHeap.prototype.toSortedArray">
        function <span class="apidocSignatureSpan">pmx.BinaryHeap.prototype.</span>toSortedArray
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toSortedArray = function () {
  var array = [];
  var clone = this.clone();

  while (true) {
    var element = clone.removeFirst();
    if (element === undefined) break;

    array.push(element);
  }

  return array;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }

  if (now &gt;= this._nextRescale) this._rescale(now);
};

ExponentiallyDecayingSample.prototype.toSortedArray = function() {
  return this._elements
    .<span class="apidocCodeKeywordSpan">toSortedArray</span>()
    .map(function(element) {
      return element.value;
    });
};


ExponentiallyDecayingSample.prototype.toArray = function() {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.EDS" id="apidoc.module.pmx.EDS">module pmx.EDS</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.EDS.EDS" id="apidoc.element.pmx.EDS.EDS">
        function <span class="apidocSignatureSpan">pmx.</span>EDS
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ExponentiallyDecayingSample(options) {
  options = options || {};

  this._elements = new BinaryHeap({
    score: function(element) {
      return -element.priority;
    }
  });

  this._rescaleInterval = options.rescaleInterval || ExponentiallyDecayingSample.RESCALE_INTERVAL;
  this._alpha           = options.alpha || ExponentiallyDecayingSample.ALPHA;
  this._size            = options.size || ExponentiallyDecayingSample.SIZE;
  this._random          = options.random || this._random;
  this._landmark        = null;
  this._nextRescale     = null;
  this._mean            = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>








</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.EDS.prototype" id="apidoc.module.pmx.EDS.prototype">module pmx.EDS.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.EDS.prototype._priority" id="apidoc.element.pmx.EDS.prototype._priority">
        function <span class="apidocSignatureSpan">pmx.EDS.prototype.</span>_priority
        <span class="apidocSignatureSpan">(age)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_priority = function (age) {
  return this._weight(age) / this._random();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

timestamp = timestamp || now;

var newSize = this._elements.size() + 1;

var element = {
  priority: this.<span class="apidocCodeKeywordSpan">_priority</span>(timestamp - this._landmark),
  value: value
};

if (newSize &lt;= this._size) {
  this._elements.add(element);
} else if (element.priority &gt; this._elements.first().priority) {
  this._elements.removeFirst();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.EDS.prototype._random" id="apidoc.element.pmx.EDS.prototype._random">
        function <span class="apidocSignatureSpan">pmx.EDS.prototype.</span>_random
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_random = function () {
  return Math.random();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
ExponentiallyDecayingSample.prototype._weight = function(age) {
  // We divide by 1000 to not run into huge numbers before reaching a
  // rescale event.
  return Math.exp(this._alpha * (age / 1000));
};

ExponentiallyDecayingSample.prototype._priority = function(age) {
  return this._weight(age) / this.<span class="apidocCodeKeywordSpan">_random</span>();
};

ExponentiallyDecayingSample.prototype._random = function() {
  return Math.random();
};

ExponentiallyDecayingSample.prototype._rescale = function(now) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.EDS.prototype._rescale" id="apidoc.element.pmx.EDS.prototype._rescale">
        function <span class="apidocSignatureSpan">pmx.EDS.prototype.</span>_rescale
        <span class="apidocSignatureSpan">(now)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_rescale = function (now) {
  now               = now || Date.now();

  var self          = this;
  var oldLandmark   = this._landmark;
  this._landmark    = now || Date.now();
  this._nextRescale = now + this._rescaleInterval;

  var factor = self._priority(-(self._landmark - oldLandmark));

  this._elements
    .toArray()
    .forEach(function(element) {
      element.priority *= factor;
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (newSize &lt;= this._size) {
  this._elements.add(element);
} else if (element.priority &gt; this._elements.first().priority) {
  this._elements.removeFirst();
  this._elements.add(element);
}

if (now &gt;= this._nextRescale) this.<span class="apidocCodeKeywordSpan">_rescale</span>(now);
};

ExponentiallyDecayingSample.prototype.toSortedArray = function() {
return this._elements
  .toSortedArray()
  .map(function(element) {
    return element.value;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.EDS.prototype._weight" id="apidoc.element.pmx.EDS.prototype._weight">
        function <span class="apidocSignatureSpan">pmx.EDS.prototype.</span>_weight
        <span class="apidocSignatureSpan">(age)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_weight = function (age) {
  // We divide by 1000 to not run into huge numbers before reaching a
  // rescale event.
  return Math.exp(this._alpha * (age / 1000));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
ExponentiallyDecayingSample.prototype._weight = function(age) {
  // We divide by 1000 to not run into huge numbers before reaching a
  // rescale event.
  return Math.exp(this._alpha * (age / 1000));
};

ExponentiallyDecayingSample.prototype._priority = function(age) {
  return this.<span class="apidocCodeKeywordSpan">_weight</span>(age) / this._random();
};

ExponentiallyDecayingSample.prototype._random = function() {
  return Math.random();
};

ExponentiallyDecayingSample.prototype._rescale = function(now) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.EDS.prototype.avg" id="apidoc.element.pmx.EDS.prototype.avg">
        function <span class="apidocSignatureSpan">pmx.EDS.prototype.</span>avg
        <span class="apidocSignatureSpan">(now)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">avg = function (now) {
  var sum = 0;
  this._elements
    .toArray()
    .forEach(function(element) {
      sum += element.value;
    });
  return (sum / this._elements.size());
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.EDS.prototype.toArray" id="apidoc.element.pmx.EDS.prototype.toArray">
        function <span class="apidocSignatureSpan">pmx.EDS.prototype.</span>toArray
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toArray = function () {
  return this._elements
    .toArray()
    .map(function(element) {
      return element.value;
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

return root;
};

BinaryHeap.prototype.clone = function() {
return new BinaryHeap({
  elements: this.<span class="apidocCodeKeywordSpan">toArray</span>(),
  score: this._score,
});
};

BinaryHeap.prototype.toSortedArray = function() {
var array = [];
var clone = this.clone();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.EDS.prototype.toSortedArray" id="apidoc.element.pmx.EDS.prototype.toSortedArray">
        function <span class="apidocSignatureSpan">pmx.EDS.prototype.</span>toSortedArray
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toSortedArray = function () {
  return this._elements
    .toSortedArray()
    .map(function(element) {
      return element.value;
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }

  if (now &gt;= this._nextRescale) this._rescale(now);
};

ExponentiallyDecayingSample.prototype.toSortedArray = function() {
  return this._elements
    .<span class="apidocCodeKeywordSpan">toSortedArray</span>()
    .map(function(element) {
      return element.value;
    });
};


ExponentiallyDecayingSample.prototype.toArray = function() {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.EDS.prototype.update" id="apidoc.element.pmx.EDS.prototype.update">
        function <span class="apidocSignatureSpan">pmx.EDS.prototype.</span>update
        <span class="apidocSignatureSpan">(value, timestamp)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">update = function (value, timestamp) {
  var now = Date.now();
  if (!this._landmark) {
    this._landmark    = now;
    this._nextRescale = this._landmark + this._rescaleInterval;
  }

  timestamp = timestamp || now;

  var newSize = this._elements.size() + 1;

  var element = {
    priority: this._priority(timestamp - this._landmark),
    value: value
  };

  if (newSize &lt;= this._size) {
    this._elements.add(element);
  } else if (element.priority &gt; this._elements.first().priority) {
    this._elements.removeFirst();
    this._elements.add(element);
  }

  if (now &gt;= this._nextRescale) this._rescale(now);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  measurement : 'mean'
});

var latency = 0;

setInterval(function() {
  latency = Math.round(Math.random() * 100);
  histogram.<span class="apidocCodeKeywordSpan">update</span>(latency);
}, 100);
```

#### Options

- **name**: Probe name
- **agg_type** : (optional)(default: none) Can be `sum`, `max`, `min`, `avg` (default) or `none`. It will impact the way the probe
 data are aggregated within the **Keymetrics** backend. Use `none` if this is irrelevant (eg: constant or string value).
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.EWMA" id="apidoc.module.pmx.EWMA">module pmx.EWMA</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.EWMA.EWMA" id="apidoc.element.pmx.EWMA.EWMA">
        function <span class="apidocSignatureSpan">pmx.</span>EWMA
        <span class="apidocSignatureSpan">(timePeriod, tickInterval)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ExponentiallyWeightedMovingAverage(timePeriod, tickInterval) {
  this._timePeriod   = timePeriod || 1 * units.MINUTE;
  this._tickInterval = tickInterval || ExponentiallyWeightedMovingAverage.TICK_INTERVAL;
  this._alpha        = 1 - Math.exp(-this._tickInterval / this._timePeriod);
  this._count        = 0;
  this._rate         = 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.EWMA.prototype" id="apidoc.module.pmx.EWMA.prototype">module pmx.EWMA.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.EWMA.prototype.rate" id="apidoc.element.pmx.EWMA.prototype.rate">
        function <span class="apidocSignatureSpan">pmx.EWMA.prototype.</span>rate
        <span class="apidocSignatureSpan">(timeUnit)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rate = function (timeUnit) {
  return (this._rate || 0) * timeUnit;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.EWMA.prototype.tick" id="apidoc.element.pmx.EWMA.prototype.tick">
        function <span class="apidocSignatureSpan">pmx.EWMA.prototype.</span>tick
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tick = function () {
  var instantRate = this._count / this._tickInterval;
  this._count     = 0;

  this._rate += (this._alpha * (instantRate - this._rate));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
 * Tick system for Alerts
 */
function checkIssues(data) {
Object.keys(data).forEach(function(probe_name) {
  if (typeof(data[probe_name].alert) !== 'undefined') {
    data[probe_name].alert.<span class="apidocCodeKeywordSpan">tick</span>(getValue(data[probe_name].value));
  }
});
};

function attachAlert(opts, conf) {
/**
 * pm2 set module-name:probes:probe_name:value    20
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.EWMA.prototype.update" id="apidoc.element.pmx.EWMA.prototype.update">
        function <span class="apidocSignatureSpan">pmx.EWMA.prototype.</span>update
        <span class="apidocSignatureSpan">(n)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">update = function (n) {
  this._count += n;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  measurement : 'mean'
});

var latency = 0;

setInterval(function() {
  latency = Math.round(Math.random() * 100);
  histogram.<span class="apidocCodeKeywordSpan">update</span>(latency);
}, 100);
```

#### Options

- **name**: Probe name
- **agg_type** : (optional)(default: none) Can be `sum`, `max`, `min`, `avg` (default) or `none`. It will impact the way the probe
 data are aggregated within the **Keymetrics** backend. Use `none` if this is irrelevant (eg: constant or string value).
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.Probe" id="apidoc.module.pmx.Probe">module pmx.Probe</a></h1>




    <h2>
        <a href="#apidoc.element.pmx.Probe.probe" id="apidoc.element.pmx.Probe.probe">
        function <span class="apidocSignatureSpan">pmx.Probe.</span>probe
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">probe = function () {
  var self = this;
  // Get module configuration to enable alerts
  if (this.getConf &amp;&amp; this.getConf())
    Probe._alert_activated = this.getConf().alert_enabled || true;
  else
    Probe._alert_activated = false;

  if (Probe._started == false) {
    Probe._started = true;

    var p_interval = setInterval(function() {
      Transport.send({
        type : 'axm:monitor',
        data : cookData(Probe._var)
      });
      checkIssues(Probe._var);
    }, 990);

    p_interval.unref();
  }

  return {
<span class="apidocCodeCommentSpan">    /**
     * This reflect data to keymetrics
     * pmx.transpose('prop name', fn)
     *
     * or
     *
     * pmx.transpose({
     *   name : 'variable name',
     *   data : function() { return value }
     * });
     */
</span>    transpose : function(variable_name, reporter) {
      if (typeof variable_name === 'object') {
        reporter = variable_name.data;
        variable_name = variable_name.name;
      }

      if (typeof reporter !== 'function') {
        return console.error('[PMX] reporter is not a function');
      }

      Probe._var[variable_name] = {
        value: reporter
      };
    },
    metric : function(opts) {
      var agg_type = opts.agg_type || Probe.default_aggregation;

      if (!opts.name)
        return console.error('[Probe][Metric] Name not defined');
      if (Probe.AVAILABLE_AGG_TYPES.indexOf(agg_type) == -1)
        return console.error("[Probe][Metric] Unknown agg_type: %s", agg_type);

      Probe._var[opts.name] = {
        value   : opts.value || 0,
        agg_type: agg_type
      };

      /**
       * Attach alert to: Probe._var[opts.name].alert
       */
      if (self.getConf)
        attachAlert(opts, self.getConf());

      return {
        val : function() {
          var value = Probe._var[opts.name].value;

          if (typeof(value) == 'function')
            value = value();

          return value;
        },
        set : function(dt) {
          Probe._var[opts.name].value = dt;
        }
      };
    },
    histogram : function(opts) {
      if (!opts.name)
        return console.error('[Probe][Histogram] Name not defined');
      opts.measurement = opts.measurement || 'mean';
      opts.unit = opts.unit || '';
      var agg_type = opts.agg_type || Probe.default_aggregation;

      if (Probe.AVAILABLE_MEASUREMENTS.indexOf(opts.measurement) == -1)
        return console.error('[Probe][Histogram] Measure type %s does not exists', opts.measurement);
      if (Probe.AVAILABLE_AGG_TYPES.indexOf(agg_type) == -1)
        return console.error("[Probe][Metric] Unknown agg_type: %s", agg_type);

      var histogram = new Histogram(opts);

      Probe._var[opts.name] = {
        value: function() { return (Math.round(histogram.val() * 100) / 100) + '' + opts.unit },
        agg_type: agg_type
      };

      /**
       * Attach alert to: Probe._var[opts.name].alert
       */
      if (self.getConf)
        attachAlert(opts, self.getConf());

      return histogram;
    },
    meter : function(opts) {
      var agg_type = opts.agg_type || Probe.default_aggregation;

      if (!opts.name)
        return console.error('[Probe][Meter] Name not defined');
      if (Probe.AVAILABLE_AGG_TYPES.indexOf(agg_type) == -1)
        return console.error("[Probe][Metric] Unknown agg_type: %s", agg_type);

      opts.unit = opts.unit || '';

      var meter = new Meter(opts);

      Probe._var[opts.name] = {
        value: function() { return meter.val() + '' + opts.unit },
        agg_type: agg_type
      };

      /**
       * Attach alert to: Probe._var[opts.name].alert
       */
      if (self.getConf)
        attachAlert(opts, self.getConf());

      return meter;
    },
    counter : function(opts) {
      var agg_type = opts.agg_type || Probe.default_aggregation;

      if (!opts.name)
        return console.error('[Probe][Counter] Name not defined');
      if (Probe.AVAILABLE_AGG_TYPES.indexOf(agg_type) == -1)
        return console.error("[Probe][Metric] Unknown agg_type: %s", agg_type);

      var counter = new Counter();

      Probe._var[opts.name] = {
        value: ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  - eg. Monitor the mean of execution of a query into database

### Metric: Simple value reporting

This allow to expose values that can be read instantly.

```javascript
var probe = pmx.<span class="apidocCodeKeywordSpan">probe</span>();

// Here the value function will be called each second to get the value
// returned by Object.keys(users).length
var metric = probe.metric({
name    : 'Realtime user',
value   : function() {
  return Object.keys(users).length;
...</pre></li>
    </ul>










</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.actions" id="apidoc.module.pmx.actions">module pmx.actions</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.actions.action" id="apidoc.element.pmx.actions.action">
        function <span class="apidocSignatureSpan">pmx.actions.</span>action
        <span class="apidocSignatureSpan">(action_name, opts, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">action = function (action_name, opts, fn) {
  if (!fn) {
    fn = opts;
    opts = null;
  }

  if (!action_name)
    return console.error('[PMX] action.action_name is missing');
  if (!fn)
    return console.error('[PMX] emit.data is mission');

  if (!process.send) {
    debug('Process not running within PM2');
    return false;
  }

  // Notify the action
  Transport.send({
    type : 'axm:action',
    data : {
      action_name : action_name,
      opts        : opts,
      arity       : fn.length
    }
  });

  function reply(data) {
    if (data.length) {
      data._length = data.length;
      delete data.length;
    }

    Transport.send({
      type        : 'axm:reply',
      data        : {
        return      : data,
        action_name : action_name
      }
    });
  }

  process.on('message', function(data) {
    if (!data) return false;

    // In case 2 arguments has been set but no options has been transmitted
    if (fn.length === 2 &amp;&amp; typeof(data) === 'string' &amp;&amp; data === action_name)
      return fn({}, reply);

    // In case 1 arguments has been set but options has been transmitted
    if (fn.length === 1 &amp;&amp; typeof(data) === 'object' &amp;&amp; data.msg === action_name)
      return fn(reply);

<span class="apidocCodeCommentSpan">    /**
     * Classical call
     */
</span>    if (typeof(data) === 'string' &amp;&amp; data === action_name)
      return fn(reply);

    /**
     * If data is an object == v2 protocol
     * Pass the opts as first argument
     */
    if (typeof(data) === 'object' &amp;&amp; data.msg === action_name)
      return fn(data.opts, reply);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Simple action allows to trigger a function from Keymetrics. The function takes a function as a parameter (reply here) and need to
 be called once the job is finished.

Example:

```javascript
var pmx = require('pmx');

pmx.<span class="apidocCodeKeywordSpan">action</span>('db:clean', function(reply) {
  clean.db(function() {
    /**
     * reply() must be called at the end of the action
     */
     reply({success : true});
  });
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.actions.scopedAction" id="apidoc.element.pmx.actions.scopedAction">
        function <span class="apidocSignatureSpan">pmx.actions.</span>scopedAction
        <span class="apidocSignatureSpan">(action_name, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">scopedAction = function (action_name, fn) {

  if (!action_name)
    return console.error('[PMX] action.action_name is missing');
  if (!fn)
    return console.error('[PMX] callback is missing');

  if (!process.send) {
    debug('Process not running within PM2');
    return false;
  }

  // Notify the action
  Transport.send({
    type : 'axm:action',
    data : {
      action_name : action_name,
      action_type : 'scoped'
    }
  });

  process.on('message', function(data) {
    if (!data
        || data.uuid === undefined
        || data.action_name === undefined)
      return false;

    if (data.action_name === action_name) {
      var res = {
        send : function(dt) {
          Transport.send({
            type        : 'axm:scoped_action:stream',
            data        : {
              data        : dt,
              uuid        : data.uuid,
              action_name : action_name
            }
          });
        },
        error : function(dt) {
          Transport.send({
            type        : 'axm:scoped_action:error',
            data        : {
              data        : dt,
              uuid        : data.uuid,
              action_name : action_name
            }
          });
        },
        end : function(dt) {
          Transport.send({
            type        : 'axm:scoped_action:end',
            data        : {
              data        : dt,
              uuid        : data.uuid,
              action_name : action_name
            }
          });
        }
      };

      var d = domain.create();

      d.on('error', function(err) {
        res.error(err.message || err.stack || err);
        setTimeout(function() {
          process.exit(1);
        }, 300);
      });

      d.run(function() {
        fn(data.opts || null, res);
      });
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Scoped Actions are advanced remote actions that can be also triggered from Keymetrics.

Two arguments are passed to the function, data (optional data sent from Keymetrics) and res that allows to emit log data and to
end the scoped action.

Example:

```javascript
pmx.<span class="apidocCodeKeywordSpan">scopedAction</span>('long running lsof', function(data, res) {
var child = spawn('lsof', []);

child.stdout.on('data', function(chunk) {
  chunk.toString().split('\n').forEach(function(line) {
    res.send(line); // This send log to Keymetrics to be saved (for tracking)
  });
});
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.alert" id="apidoc.module.pmx.alert">module pmx.alert</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.alert.alert" id="apidoc.element.pmx.alert.alert">
        function <span class="apidocSignatureSpan">pmx.</span>alert
        <span class="apidocSignatureSpan">(opts, extra)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">alert = function (opts, extra) {
  var self = this;
  var cmp;

  if (typeof(opts.mode) === 'undefined')
    return console.error('[Probe][Metric] Mode undefined!');
  if (typeof(opts.cmp) === 'string') {
    switch(opts.cmp) {
      case '&gt;':
      cmp = function(a,b) {
          return (a &gt; b);
        };
        break;
      case '&lt;':
       cmp = function(a, b) {
          return (a &lt; b);
        };
        break;
      case '=':
         cmp = function(a,b) {
          return (a === b);
        };
        break;
      default:
        return console.error('[Probe][Metric] Mode does not exist!');
    }
    self.cmp_mode = opts.cmp;
    opts.cmp = null;
  }
  else {
    cmp = function(a,b) {
      return (a &gt; b);
    };
    self.cmp_mode = '&gt;';
  }
  switch(opts.mode) {
    case 'threshold':
      if (typeof(opts.value) === 'undefined')
        return console.error('[Probe][Metric][threshold] Val undefined!');
      this.cmp = opts.cmp || function(a,b) {
        return cmp(parseFloat(a), b);
      };
      break;
    case 'threshold-avg':
      if (typeof(opts.value) === 'undefined')
        return console.error('[Probe][Metric][threshold-avg] Val undefined!');
      this.sample = new Sample(opts.interval || 180);
      this.cmp = function(value, threshold) {
        this.sample.update(parseFloat(value));
        if (this.start) {
          if (typeof(opts.cmp) !== 'undefined' &amp;&amp; opts.cmp !== null)
            return opts.cmp(this.sample.getMean(), threshold);
          return cmp(this.sample.getMean(), threshold);
        }
      };
      break;
    case 'smart':
      this.sample = new Sample(opts.interval || 300);
      this.small = new Sample(opts.sample || 30);
      this.cmp = function(value, threshold) {
        if (value !== null) {
          this.sample.update(parseFloat(value));
          this.small.update(parseFloat(value));
        //debug('Check', value, Math.exp(- Math.pow(value - this.sample.getMean(), 2) / (2 * this.sample.getVariance())) / (Math
.sqrt(2 * Math.PI) * this.sample.getStddev()));

          if (this.start)
          //return false
            return (Math.exp(- Math.pow(value - this.sample.getMean(), 2) / (2 * this.sample.getVariance())) / (Math.sqrt(2 * Math
.PI) * this.sample.getStddev()) &lt; 0.00000001)
        }
        return false;
      };
      break;
    default:
      return console.error('[Probe][Metric] Mode does not exist!');
  }
  this.mode = opts.mode;
  this.start = false;
  //Start the data checking after 30s (default)
  setTimeout(function() {
    self.start = true;
  }, opts.timeout || 30000);
  this.reached = 0;
  this.nullCheck = 0;
  this.value =  opts.value || null;
  this.msg = opts.msg || ((extra &amp;&amp; extra.name) ? ('Probe ' + extra.name + ' has reached value') : 'Alert value reached');
  this.func = opts.func || opts.action || null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.alert.prototype" id="apidoc.module.pmx.alert.prototype">module pmx.alert.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.alert.prototype.serialize" id="apidoc.element.pmx.alert.prototype.serialize">
        function <span class="apidocSignatureSpan">pmx.alert.prototype.</span>serialize
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">serialize = function () {
  var self = this;

  var ret = {
    mode  : self.mode
  };

  if (this.mode == 'threshold') {
    ret.value = self.value;
    ret.cmp   = self.cmp_mode;
  }

  if (this.mode == 'threshold-avg') {
    ret.value    = self.value;
    ret.interval = self.sample._size;
    ret.cmp      = self.cmp_mode;
  }

  return ret;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        data[probe_name].agg_type != 'none')
      cooked_data[probe_name].agg_type = data[probe_name].agg_type;

    /**
     * Attach Alert configuration
     */
    if (data[probe_name].alert)
      cooked_data[probe_name].alert = data[probe_name].alert.<span class="apidocCodeKeywordSpan">serialize</span>();
    else
      cooked_data[probe_name].alert = {};

  });
  return cooked_data;
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.alert.prototype.tick" id="apidoc.element.pmx.alert.prototype.tick">
        function <span class="apidocSignatureSpan">pmx.alert.prototype.</span>tick
        <span class="apidocSignatureSpan">(value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tick = function (value) {
  var self = this;
  if (this.reached === 0) {
    //Need 10 times null to trigger alert
    if (value === null &amp;&amp; this.nullCheck &lt; 10) {
      this.nullCheck += 1;
    }
    else if (this.cmp(value, this.value)) {
      Notify.notify(this.msg + ' ' + this.value);
      // Delay a bit call to custom function to allow PM2 to receive notify msg
      if (this.func) setTimeout(function() {self.func(value)}, 50);
      this.reached = 1;
      this.nullCheck = 0;
    }
  }
  else if (typeof(this.reached) !== 'undefined') {
    if (!this.cmp(value, this.value))
      this.reached = 0;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
 * Tick system for Alerts
 */
function checkIssues(data) {
Object.keys(data).forEach(function(probe_name) {
  if (typeof(data[probe_name].alert) !== 'undefined') {
    data[probe_name].alert.<span class="apidocCodeKeywordSpan">tick</span>(getValue(data[probe_name].value));
  }
});
};

function attachAlert(opts, conf) {
/**
 * pm2 set module-name:probes:probe_name:value    20
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.common" id="apidoc.module.pmx.common">module pmx.common</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.common.getDate" id="apidoc.element.pmx.common.getDate">
        function <span class="apidocSignatureSpan">pmx.common.</span>getDate
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getDate() {
  return Math.round(Date.now() / 1000);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.configuration" id="apidoc.module.pmx.configuration">module pmx.configuration</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.configuration.configureModule" id="apidoc.element.pmx.configuration.configureModule">
        function <span class="apidocSignatureSpan">pmx.configuration.</span>configureModule
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">configureModule = function (opts) {
  Transport.send({
    type : 'axm:option:configuration',
    data : opts
  }, false);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
} catch(e) {
  //console.error(e);
  //console.error('Error while parsing configuration in environment (%s)', conf.module_name);
}

if (do_not_tell_pm2 == true) return conf;

Options.<span class="apidocCodeKeywordSpan">configureModule</span>(conf);
return conf;
};

Options.getPID = function(file) {
if (typeof(file) === 'number')
  return file;
return parseInt(fs.readFileSync(file).toString());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.configuration.getPID" id="apidoc.element.pmx.configuration.getPID">
        function <span class="apidocSignatureSpan">pmx.configuration.</span>getPID
        <span class="apidocSignatureSpan">(file)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getPID = function (file) {
  if (typeof(file) === 'number')
    return file;
  return parseInt(fs.readFileSync(file).toString());
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.configuration.init" id="apidoc.element.pmx.configuration.init">
        function <span class="apidocSignatureSpan">pmx.configuration.</span>init
        <span class="apidocSignatureSpan">(conf, do_not_tell_pm2)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (conf, do_not_tell_pm2) {
  var package_filepath = findPackageJson();
  var package_json;

  if (!conf.module_conf)
    conf.module_conf = {};

  if (conf.isModule == true) {
<span class="apidocCodeCommentSpan">    /**
     * Merge package.json metadata
     */
</span>    try {
      package_json = require(package_filepath);

      conf.module_version = package_json.version;
      conf.module_name    = package_json.name;
      conf.description    = package_json.description;
      conf.pmx_version    = null;

      if (pkg.version)
        conf.pmx_version    = pkg.version;

      if (package_json.config) {
        conf = util._extend(conf, package_json.config);
        conf.module_conf = package_json.config;
      }
    } catch(e) {
      throw new Error(e);
    }
  } else {
    conf.module_name = process.env.name || 'outside-pm2';
    try {
      package_json = require(package_filepath);

      conf.module_version = package_json.version;
      conf.pmx_version    = null;

      if (pkg.version)
        conf.pmx_version    = pkg.version;

      if (package_json.config) {
        conf = util._extend(conf, package_json.config);
        conf.module_conf = package_json.config;
      }
    } catch(e) {
    }
  }

  /**
   * If custom variables has been set, merge with returned configuration
   */
  try {
    if (process.env[conf.module_name]) {
      var casted_conf = Autocast(JSON.parse(process.env[conf.module_name]));
      conf = util._extend(conf, casted_conf);
      // Do not display probe configuration in Keymetrics
      delete casted_conf.probes;
      // This is the configuration variable modifiable from keymetrics
      conf.module_conf = JSON.parse(JSON.stringify(util._extend(conf.module_conf, casted_conf)));

      // Obfuscate passwords
      Object.keys(conf.module_conf).forEach(function(key) {
        if ((key == 'password' || key == 'passwd') &amp;&amp;
            conf.module_conf[key].length &gt;= 1) {
          conf.module_conf[key] = 'Password hidden';
        }

      });
    }
  } catch(e) {
    //console.error(e);
    //console.error('Error while parsing configuration in environment (%s)', conf.module_name);
  }

  if (do_not_tell_pm2 == true) return conf;

  Options.configureModule(conf);
  return conf;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
You can monitor the network usage of a specific application by adding the option `network: true` when initializing PMX. If you enable
 the flag `ports: true` when you init pmx it will show which ports your app is listenting on.

These metrics will be shown in the Keymetrics Dashboard in the Custom Metrics section.

Example:

```javascript
pmx.<span class="apidocCodeKeywordSpan">init</span>({
  [...]
  network : true, // Allow application level network monitoring
  ports   : true  // Display ports used by the application
});
```

## Advanced PMX configuration
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.configuration.resolvePidPaths" id="apidoc.element.pmx.configuration.resolvePidPaths">
        function <span class="apidocSignatureSpan">pmx.configuration.</span>resolvePidPaths
        <span class="apidocSignatureSpan">(filepaths)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">resolvePidPaths = function (filepaths) {
  if (typeof(filepaths) === 'number')
    return filepaths;

  function detect(filepaths) {
    var content = '';

    filepaths.some(function(filepath) {
      try {
        content = fs.readFileSync(filepath);
      } catch(e) {
        return false;
      }
      return true;
    });

    return content.toString().trim();
  }

  var ret = parseInt(detect(filepaths));

  return isNaN(ret) ? null : ret;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.datachecker" id="apidoc.module.pmx.datachecker">module pmx.datachecker</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.datachecker.datachecker" id="apidoc.element.pmx.datachecker.datachecker">
        function <span class="apidocSignatureSpan">pmx.</span>datachecker
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function dataChecker(opts) {
  var self = this;
  this._counter = 0;

  opts = opts || {};

  if (typeof(opts.refresh) !== 'function')
    throw new Error('Refresh not defined or not a function');

  this._refresh = opts.refresh;

  this._monitored = false;
  this._launch = opts.launch || 10000;
  this._ceil = opts.ceil || 5;
  this._timer = opts.timer || 1000;
  this._dev   = opts.dev || 0.2;
  this._callback = opts.callback || null;
  this._histogram = new Histogram();
  this._calcDev = opts.calcDev || 'ema';

<span class="apidocCodeCommentSpan">  /*
   * Select function to compute deviation
   */
</span>  var func = {
    ema    : this.normalDev,
    mean   : this.medianDev
  }
  this.computeDev = func[this._calcDev];

  /**
   * Display some probe if we need to debug
   */
  if (opts.debug === true) {
    if (opts.probes.indexOf('val') != -1) {
      this._metric2 = new probe.metric({
        name  : 'Value',
        value : function() {
          return self._refresh();
        }
      });
    }
    if (opts.probes.indexOf('ema') != -1) {
      this._metric3 = new probe.metric({
        name  : 'EMA',
        value : function() {
          return self._histogram.getEma();
        }
      });
    }
  }
  /**
    * Delay before monitoring starts
    */
  setTimeout(function() {
    self._monitored = true;
  }, this._launch);
  this.start();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.datachecker.prototype" id="apidoc.module.pmx.datachecker.prototype">module pmx.datachecker.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.datachecker.prototype.medianDev" id="apidoc.element.pmx.datachecker.prototype.medianDev">
        function <span class="apidocSignatureSpan">pmx.datachecker.prototype.</span>medianDev
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">medianDev = function () {
  return ((this._histogram.getEma() - this._histogram._calculateMean()) / this._histogram._calculateMean() &gt; this._dev);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.datachecker.prototype.normalDev" id="apidoc.element.pmx.datachecker.prototype.normalDev">
        function <span class="apidocSignatureSpan">pmx.datachecker.prototype.</span>normalDev
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">normalDev = function () {
  return ((this._refresh() - this._histogram.getEma()) / this._histogram.getEma() &gt; this._dev);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.datachecker.prototype.start" id="apidoc.element.pmx.datachecker.prototype.start">
        function <span class="apidocSignatureSpan">pmx.datachecker.prototype.</span>start
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">start = function () {
  var self = this;

  debug('Checker started');

  this._interval_timer = setInterval(function() {
    self._histogram.update(self._refresh());

    debug('Check', self._refresh(), self._histogram._calculateMean(), self._histogram.getEma());

    if (self._monitored === true &amp;&amp; self.computeDev() === true) {
      self._counter++;
<span class="apidocCodeCommentSpan">      /**
        * Triggers callback after N consecutive errors, then resets the counter
        */
</span>      if (self._counter &gt;= self._ceil) {
        debug('Anomaly detected', self._histogram.getEma(), self._refresh());
        self._callback();
        self.counter = 0;
      }
    }
    else
      self._counter = 0;
  }, self._timer);

  this._interval_timer.unref();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Transaction.tracing = function (pmx, opts) {

if (Array.isArray(opts.ignore_routes) &amp;&amp; opts.ignore_routes.length &gt; 0) {
  opts.ignoreFilter.url = opts.ignore_routes;
}

Transaction.tracer = require('vxx').<span class="apidocCodeKeywordSpan">start</span>(opts);

Options.configureModule({
  tracing_enabled : true
});

// broadcast to pm2 aggregator
Transaction.tracer.getBus().on('transaction', function(data) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.datachecker.prototype.stop" id="apidoc.element.pmx.datachecker.prototype.stop">
        function <span class="apidocSignatureSpan">pmx.datachecker.prototype.</span>stop
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stop = function () {
  clearInterval(this._interval_timer);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.events" id="apidoc.module.pmx.events">module pmx.events</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.events.emit" id="apidoc.element.pmx.events.emit">
        function <span class="apidocSignatureSpan">pmx.events.</span>emit
        <span class="apidocSignatureSpan">(name, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">emit = function (name, data) {
  if (!name)
    return console.error('[AXM] emit.name is missing');
  if (!data)
    return console.error('[AXM] emit.data is missing');

  var inflight_obj = {};

  if (typeof(data) == 'object')
    inflight_obj = JSON.parse(stringify(data));
  else {
    inflight_obj.data = data;
  }

  inflight_obj.__name = name;

  Transport.send({
    type : 'human:event',
    data : inflight_obj
  }, true);
  return false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Emit events and get historical and statistics.
This is available in the **Events** page of Keymetrics.

```javascript
var pmx = require('pmx');

pmx.<span class="apidocCodeKeywordSpan">emit</span>('user:register', {
  user : 'Alex registered',
  email : 'thorustor@gmail.com'
});
```

## Application level network traffic monitoring / Display used ports
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.monitor" id="apidoc.module.pmx.monitor">module pmx.monitor</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.monitor.enableProbe" id="apidoc.element.pmx.monitor.enableProbe">
        function <span class="apidocSignatureSpan">pmx.monitor.</span>enableProbe
        <span class="apidocSignatureSpan">(custom_namespace)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function enableProbes(custom_namespace) {
  if (!custom_namespace)
    custom_namespace = 'axm';

  if (!global[custom_namespace])
    global[custom_namespace] = {};

  if (this.interval)
    return global[custom_namespace];

  this.interval = setInterval(function() {
    Transport.send({
      type : 'axm:monitor',
      data : cookData(global[custom_namespace])
    });
  }, 990);

  this.interval.unref();

  return global[custom_namespace];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.monitor.enableProbes" id="apidoc.element.pmx.monitor.enableProbes">
        function <span class="apidocSignatureSpan">pmx.monitor.</span>enableProbes
        <span class="apidocSignatureSpan">(custom_namespace)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function enableProbes(custom_namespace) {
  if (!custom_namespace)
    custom_namespace = 'axm';

  if (!global[custom_namespace])
    global[custom_namespace] = {};

  if (this.interval)
    return global[custom_namespace];

  this.interval = setInterval(function() {
    Transport.send({
      type : 'axm:monitor',
      data : cookData(global[custom_namespace])
    });
  }, 990);

  this.interval.unref();

  return global[custom_namespace];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.monitor.stopProbe" id="apidoc.element.pmx.monitor.stopProbe">
        function <span class="apidocSignatureSpan">pmx.monitor.</span>stopProbe
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function stopProbing() {
  clearInterval(this.interval);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.monitor.stopProbes" id="apidoc.element.pmx.monitor.stopProbes">
        function <span class="apidocSignatureSpan">pmx.monitor.</span>stopProbes
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function stopProbing() {
  clearInterval(this.interval);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.network" id="apidoc.module.pmx.network">module pmx.network</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.network.catchPorts" id="apidoc.element.pmx.network.catchPorts">
        function <span class="apidocSignatureSpan">pmx.network.</span>catchPorts
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">catchPorts = function () {
  var ports_list = [];
  var opened_ports = 'N/A';

  Probe.probe().metric({
    name    : 'Open ports',
    value   : function() { return opened_ports; }
  });

  var original_listen = net_module.Server.prototype.listen;

  net_module.Server.prototype.listen = function() {
    var port = parseInt(arguments[0]);

    if (!isNaN(port) &amp;&amp; ports_list.indexOf(port) === -1) {
      ports_list.push(port);
      opened_ports = ports_list.sort().join();
    }

    this.once('close', function() {
      if (ports_list.indexOf(port) &gt; -1) {
        ports_list.splice(ports_list.indexOf(port), 1);
        opened_ports = ports_list.sort().join();
      }
    });

    return original_listen.apply(this, arguments);
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  excludedHooks: []
}, opts);

opts = Configuration.init(opts);
this._pmx_conf = opts;

if (opts.ports)
  PMX.<span class="apidocCodeKeywordSpan">catchPorts</span>();
if (opts.network)
  PMX.catchTraffic();

if (opts.transactions)
  PMX.tracing(PMX, opts);
if (opts.http)
  PMX.http(opts);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.network.catchTraffic" id="apidoc.element.pmx.network.catchTraffic">
        function <span class="apidocSignatureSpan">pmx.network.</span>catchTraffic
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">catchTraffic = function () {
  var download = 0;
  var upload   = 0;
  var up       = '0 B/sec';
  var down     = '0 B/sec';

  var filter = function(bytes) {
    var to_fixed = 0;

    if (bytes === 0)
      ;
    else if (bytes &lt; 1024)
      to_fixed = 6;
    else if (bytes &lt; (1024 * 1024))
      to_fixed = 3;
    else
      to_fixed = 2;

    bytes = (bytes / (1024 * 1024)).toFixed(to_fixed);

    var cut_zeros = 0;

    for (var i = (bytes.length - 1); i &gt; 0; --i) {
      if (bytes[i] === '.') {
        ++cut_zeros;
        break;
      }
      if (bytes[i] !== '0')
        break;
      ++cut_zeros;
    }

    if (cut_zeros &gt; 0)
      bytes = bytes.slice(0, -(cut_zeros));

    return (bytes + ' MB/s');
  };

  var interval = setInterval(function() {
    up = filter(upload);
    down = filter(download);
    upload = 0;
    download = 0;
  }, 999);

  interval.unref();

  Probe.probe().metric({
    name     : 'Network Download',
    agg_type : 'sum',
    value    : function() { return down; }
  });

  Probe.probe().metric({
    name     : 'Network Upload',
    agg_type : 'sum',
    value    : function() { return up; }
  });

  var original_write = net_module.Socket.prototype.write;

  net_module.Socket.prototype.write = function(data) {
    if (data.length)
      upload += data.length;
    return original_write.apply(this, arguments);
  };

  var original_read = net_module.Socket.prototype.read;

  net_module.Socket.prototype.read = function() {

    if (!this.monitored) {
      this.monitored = true;

      this.on('data', function(data) {
        if (data.length)
          download += data.length;
      });
    }

    return original_read.apply(this, arguments);
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

opts = Configuration.init(opts);
this._pmx_conf = opts;

if (opts.ports)
  PMX.catchPorts();
if (opts.network)
  PMX.<span class="apidocCodeKeywordSpan">catchTraffic</span>();

if (opts.transactions)
  PMX.tracing(PMX, opts);
if (opts.http)
  PMX.http(opts);

PMX.catchAll(opts);
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.notify" id="apidoc.module.pmx.notify">module pmx.notify</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.notify.notify" id="apidoc.element.pmx.notify.notify">
        function <span class="apidocSignatureSpan">pmx.</span>notify
        <span class="apidocSignatureSpan">(err)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">notify = function (err) {
  var ret_err = this._interpretError(err);

  // full_err
  //debug(ret_err);

  Transport.send({
    type : 'process:exception',
    data : ret_err
  }, true);

  return ret_err;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
### Custom alert notification

If you need to alert about any critical errors you can do it programmatically:

```javascript
var pmx = require('pmx');

pmx.<span class="apidocCodeKeywordSpan">notify</span>({ success : false });

pmx.notify('This is an error');

pmx.notify(new Error('This is an error'));
```

### Add Verbosity to an Alert: Express Error handler
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.notify._interpretError" id="apidoc.element.pmx.notify._interpretError">
        function <span class="apidocSignatureSpan">pmx.notify.</span>_interpretError
        <span class="apidocSignatureSpan">(err)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_interpretError = function (err) {
  var s_err = {};

  if (typeof(err) === 'string') {
    // Simple string processing
    s_err.message = err;
    s_err.stack = err;
  }
  else if (!(err instanceof Error) &amp;&amp; typeof(err) === 'object') {
    // JSON processing
    s_err.message = err;
    s_err.stack = err;
  }
  else if (err instanceof Error) {
    // Error object type processing
    err.stack;
    if (err.__error_callsites) {
      var stackFrames = [];
       err.__error_callsites.forEach(function(callSite) {
        stackFrames.push({ file_name: callSite.getFileName(), line_number: callSite.getLineNumber()});
      });
      err.stackframes = stackFrames;
      delete err.__error_callsites;
    }
    s_err = err;
  }

  return jsonize(s_err);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

if (listener === 'unhandledRejection') {
  error = 'You have triggered an unhandledRejection, you may have forgotten to catch a Promise rejection:\n' + error;
}

console.error(error);
if (err)
  var errObj = Notify.<span class="apidocCodeKeywordSpan">_interpretError</span>(err);

Transport.send({
  type : 'process:exception',
  data : errObj !== undefined ? errObj : {message: 'No error but ' + listener + ' was caught!' }
}, true);

if (!process.listeners(listener).filter(function (listener) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.notify.catchAll" id="apidoc.element.pmx.notify.catchAll">
        function <span class="apidocSignatureSpan">pmx.notify.</span>catchAll
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">catchAll = function (opts) {

  var callsites = require('./utils/error-callsites')

  if (opts === undefined)
    opts = { errors : true };

  Options.configureModule({
    error : opts.errors
  });

  if (process.env.exec_mode === 'cluster_mode')
    return false;

  function getUncaughtExceptionListener(listener) {
    return function uncaughtListener(err) {
      var error = err &amp;&amp; err.stack ? err.stack : err;

      if (err &amp;&amp; err.length) {
        err._length = err.length;
        delete err.length;
      }

      if (listener === 'unhandledRejection') {
        error = 'You have triggered an unhandledRejection, you may have forgotten to catch a Promise rejection:\n' + error;
      }

      console.error(error);
      if (err)
        var errObj = Notify._interpretError(err);

      Transport.send({
        type : 'process:exception',
        data : errObj !== undefined ? errObj : {message: 'No error but ' + listener + ' was caught!' }
      }, true);

      if (!process.listeners(listener).filter(function (listener) {
        return listener !== uncaughtListener;
      }).length) {

        if (listener == 'uncaughtException')
          process.exit(1);
      }
    }
  }

  if (opts.errors === true &amp;&amp; util.inspect(process.listeners('uncaughtException')).length === 2) {
    process.once('uncaughtException', getUncaughtExceptionListener('uncaughtException'));
    process.once('unhandledRejection', getUncaughtExceptionListener('unhandledRejection'));
  }
  else if (opts.errors === false
           &amp;&amp; util.inspect(process.listeners('uncaughtException')).length !== 2) {
    process.removeAllListeners('uncaughtException');
    process.removeAllListeners('unhandledRejection');
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  PMX.catchTraffic();

if (opts.transactions)
  PMX.tracing(PMX, opts);
if (opts.http)
  PMX.http(opts);

PMX.<span class="apidocCodeKeywordSpan">catchAll</span>(opts);

if (opts.profiling)
  Profiling.v8Profiling(PMX);

if (opts.custom_probes == true) {
  // Event loop monitoring
  require('./probes/pacemaker.js')(PMX);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.notify.expressErrorHandler" id="apidoc.element.pmx.notify.expressErrorHandler">
        function <span class="apidocSignatureSpan">pmx.notify.</span>expressErrorHandler
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">expressErrorHandler = function () {
  var self = this;

  Options.configureModule({
    error : true
  });

  return function errorHandler(err, req, res, next) {
    if (res.statusCode &lt; 400) res.statusCode = 500;

    //debug(err.stack || err);

    err.url = req.url;
    err.component = req.url;
    err.action = req.method;
    err.params = req.body;
    err.session = req.session;

    Transport.send({
      type  : 'process:exception',
      data  : jsonize(err)
    }, true);
    return next(err);
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// All my routes
app.get('/' ...);
app.post(...);
// All my routes

// Here I attach the middleware to get more verbosity on exception thrown
app.use(pmx.<span class="apidocCodeKeywordSpan">expressErrorHandler</span>());
```

## Emit Events

Emit events and get historical and statistics.
This is available in the **Events** page of Keymetrics.
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.pmx" id="apidoc.module.pmx.pmx">module pmx.pmx</a></h1>




    <h2>
        <a href="#apidoc.element.pmx.pmx._interpretError" id="apidoc.element.pmx.pmx._interpretError">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>_interpretError
        <span class="apidocSignatureSpan">(err)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_interpretError = function (err) {
  var s_err = {};

  if (typeof(err) === 'string') {
    // Simple string processing
    s_err.message = err;
    s_err.stack = err;
  }
  else if (!(err instanceof Error) &amp;&amp; typeof(err) === 'object') {
    // JSON processing
    s_err.message = err;
    s_err.stack = err;
  }
  else if (err instanceof Error) {
    // Error object type processing
    err.stack;
    if (err.__error_callsites) {
      var stackFrames = [];
       err.__error_callsites.forEach(function(callSite) {
        stackFrames.push({ file_name: callSite.getFileName(), line_number: callSite.getLineNumber()});
      });
      err.stackframes = stackFrames;
      delete err.__error_callsites;
    }
    s_err = err;
  }

  return jsonize(s_err);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

if (listener === 'unhandledRejection') {
  error = 'You have triggered an unhandledRejection, you may have forgotten to catch a Promise rejection:\n' + error;
}

console.error(error);
if (err)
  var errObj = Notify.<span class="apidocCodeKeywordSpan">_interpretError</span>(err);

Transport.send({
  type : 'process:exception',
  data : errObj !== undefined ? errObj : {message: 'No error but ' + listener + ' was caught!' }
}, true);

if (!process.listeners(listener).filter(function (listener) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.action" id="apidoc.element.pmx.pmx.action">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>action
        <span class="apidocSignatureSpan">(action_name, opts, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">action = function (action_name, opts, fn) {
  if (!fn) {
    fn = opts;
    opts = null;
  }

  if (!action_name)
    return console.error('[PMX] action.action_name is missing');
  if (!fn)
    return console.error('[PMX] emit.data is mission');

  if (!process.send) {
    debug('Process not running within PM2');
    return false;
  }

  // Notify the action
  Transport.send({
    type : 'axm:action',
    data : {
      action_name : action_name,
      opts        : opts,
      arity       : fn.length
    }
  });

  function reply(data) {
    if (data.length) {
      data._length = data.length;
      delete data.length;
    }

    Transport.send({
      type        : 'axm:reply',
      data        : {
        return      : data,
        action_name : action_name
      }
    });
  }

  process.on('message', function(data) {
    if (!data) return false;

    // In case 2 arguments has been set but no options has been transmitted
    if (fn.length === 2 &amp;&amp; typeof(data) === 'string' &amp;&amp; data === action_name)
      return fn({}, reply);

    // In case 1 arguments has been set but options has been transmitted
    if (fn.length === 1 &amp;&amp; typeof(data) === 'object' &amp;&amp; data.msg === action_name)
      return fn(reply);

<span class="apidocCodeCommentSpan">    /**
     * Classical call
     */
</span>    if (typeof(data) === 'string' &amp;&amp; data === action_name)
      return fn(reply);

    /**
     * If data is an object == v2 protocol
     * Pass the opts as first argument
     */
    if (typeof(data) === 'object' &amp;&amp; data.msg === action_name)
      return fn(data.opts, reply);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Simple action allows to trigger a function from Keymetrics. The function takes a function as a parameter (reply here) and need to
 be called once the job is finished.

Example:

```javascript
var pmx = require('pmx');

pmx.<span class="apidocCodeKeywordSpan">action</span>('db:clean', function(reply) {
  clean.db(function() {
    /**
     * reply() must be called at the end of the action
     */
     reply({success : true});
  });
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.catchAll" id="apidoc.element.pmx.pmx.catchAll">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>catchAll
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">catchAll = function (opts) {

  var callsites = require('./utils/error-callsites')

  if (opts === undefined)
    opts = { errors : true };

  Options.configureModule({
    error : opts.errors
  });

  if (process.env.exec_mode === 'cluster_mode')
    return false;

  function getUncaughtExceptionListener(listener) {
    return function uncaughtListener(err) {
      var error = err &amp;&amp; err.stack ? err.stack : err;

      if (err &amp;&amp; err.length) {
        err._length = err.length;
        delete err.length;
      }

      if (listener === 'unhandledRejection') {
        error = 'You have triggered an unhandledRejection, you may have forgotten to catch a Promise rejection:\n' + error;
      }

      console.error(error);
      if (err)
        var errObj = Notify._interpretError(err);

      Transport.send({
        type : 'process:exception',
        data : errObj !== undefined ? errObj : {message: 'No error but ' + listener + ' was caught!' }
      }, true);

      if (!process.listeners(listener).filter(function (listener) {
        return listener !== uncaughtListener;
      }).length) {

        if (listener == 'uncaughtException')
          process.exit(1);
      }
    }
  }

  if (opts.errors === true &amp;&amp; util.inspect(process.listeners('uncaughtException')).length === 2) {
    process.once('uncaughtException', getUncaughtExceptionListener('uncaughtException'));
    process.once('unhandledRejection', getUncaughtExceptionListener('unhandledRejection'));
  }
  else if (opts.errors === false
           &amp;&amp; util.inspect(process.listeners('uncaughtException')).length !== 2) {
    process.removeAllListeners('uncaughtException');
    process.removeAllListeners('unhandledRejection');
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  PMX.catchTraffic();

if (opts.transactions)
  PMX.tracing(PMX, opts);
if (opts.http)
  PMX.http(opts);

PMX.<span class="apidocCodeKeywordSpan">catchAll</span>(opts);

if (opts.profiling)
  Profiling.v8Profiling(PMX);

if (opts.custom_probes == true) {
  // Event loop monitoring
  require('./probes/pacemaker.js')(PMX);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.catchPorts" id="apidoc.element.pmx.pmx.catchPorts">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>catchPorts
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">catchPorts = function () {
  var ports_list = [];
  var opened_ports = 'N/A';

  Probe.probe().metric({
    name    : 'Open ports',
    value   : function() { return opened_ports; }
  });

  var original_listen = net_module.Server.prototype.listen;

  net_module.Server.prototype.listen = function() {
    var port = parseInt(arguments[0]);

    if (!isNaN(port) &amp;&amp; ports_list.indexOf(port) === -1) {
      ports_list.push(port);
      opened_ports = ports_list.sort().join();
    }

    this.once('close', function() {
      if (ports_list.indexOf(port) &gt; -1) {
        ports_list.splice(ports_list.indexOf(port), 1);
        opened_ports = ports_list.sort().join();
      }
    });

    return original_listen.apply(this, arguments);
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  excludedHooks: []
}, opts);

opts = Configuration.init(opts);
this._pmx_conf = opts;

if (opts.ports)
  PMX.<span class="apidocCodeKeywordSpan">catchPorts</span>();
if (opts.network)
  PMX.catchTraffic();

if (opts.transactions)
  PMX.tracing(PMX, opts);
if (opts.http)
  PMX.http(opts);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.catchTraffic" id="apidoc.element.pmx.pmx.catchTraffic">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>catchTraffic
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">catchTraffic = function () {
  var download = 0;
  var upload   = 0;
  var up       = '0 B/sec';
  var down     = '0 B/sec';

  var filter = function(bytes) {
    var to_fixed = 0;

    if (bytes === 0)
      ;
    else if (bytes &lt; 1024)
      to_fixed = 6;
    else if (bytes &lt; (1024 * 1024))
      to_fixed = 3;
    else
      to_fixed = 2;

    bytes = (bytes / (1024 * 1024)).toFixed(to_fixed);

    var cut_zeros = 0;

    for (var i = (bytes.length - 1); i &gt; 0; --i) {
      if (bytes[i] === '.') {
        ++cut_zeros;
        break;
      }
      if (bytes[i] !== '0')
        break;
      ++cut_zeros;
    }

    if (cut_zeros &gt; 0)
      bytes = bytes.slice(0, -(cut_zeros));

    return (bytes + ' MB/s');
  };

  var interval = setInterval(function() {
    up = filter(upload);
    down = filter(download);
    upload = 0;
    download = 0;
  }, 999);

  interval.unref();

  Probe.probe().metric({
    name     : 'Network Download',
    agg_type : 'sum',
    value    : function() { return down; }
  });

  Probe.probe().metric({
    name     : 'Network Upload',
    agg_type : 'sum',
    value    : function() { return up; }
  });

  var original_write = net_module.Socket.prototype.write;

  net_module.Socket.prototype.write = function(data) {
    if (data.length)
      upload += data.length;
    return original_write.apply(this, arguments);
  };

  var original_read = net_module.Socket.prototype.read;

  net_module.Socket.prototype.read = function() {

    if (!this.monitored) {
      this.monitored = true;

      this.on('data', function(data) {
        if (data.length)
          download += data.length;
      });
    }

    return original_read.apply(this, arguments);
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

opts = Configuration.init(opts);
this._pmx_conf = opts;

if (opts.ports)
  PMX.catchPorts();
if (opts.network)
  PMX.<span class="apidocCodeKeywordSpan">catchTraffic</span>();

if (opts.transactions)
  PMX.tracing(PMX, opts);
if (opts.http)
  PMX.http(opts);

PMX.catchAll(opts);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.configureModule" id="apidoc.element.pmx.pmx.configureModule">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>configureModule
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">configureModule = function (opts) {
  Transport.send({
    type : 'axm:option:configuration',
    data : opts
  }, false);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
} catch(e) {
  //console.error(e);
  //console.error('Error while parsing configuration in environment (%s)', conf.module_name);
}

if (do_not_tell_pm2 == true) return conf;

Options.<span class="apidocCodeKeywordSpan">configureModule</span>(conf);
return conf;
};

Options.getPID = function(file) {
if (typeof(file) === 'number')
  return file;
return parseInt(fs.readFileSync(file).toString());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.detectV8Profiler" id="apidoc.element.pmx.pmx.detectV8Profiler">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>detectV8Profiler
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">detectV8Profiler = function (cb) {
  var require_paths = require.main.paths.slice();

  (function look_for_profiler(require_paths) {
    if (!require_paths[0])
      return cb(new Error('Module not found'));

    var profiler_path = path.join(require_paths[0], 'v8-profiler');

    fs.exists(profiler_path, function(exist) {
      if (exist)
        return cb(null, profiler_path);

      require_paths.shift();
      return look_for_profiler(require_paths);
    });
    return false;
  })(require_paths);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      return look_for_profiler(require_paths);
    });
    return false;
  })(require_paths);
};

Profiling.v8Profiling = function(pmx) {
  Profiling.<span class="apidocCodeKeywordSpan">detectV8Profiler</span>(function(err, profiler_path) {
    if (err)
      return false;
    return Profiling.exposeProfiling(pmx, profiler_path);
  });
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.emit" id="apidoc.element.pmx.pmx.emit">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>emit
        <span class="apidocSignatureSpan">(name, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">emit = function (name, data) {
  if (!name)
    return console.error('[AXM] emit.name is missing');
  if (!data)
    return console.error('[AXM] emit.data is missing');

  var inflight_obj = {};

  if (typeof(data) == 'object')
    inflight_obj = JSON.parse(stringify(data));
  else {
    inflight_obj.data = data;
  }

  inflight_obj.__name = name;

  Transport.send({
    type : 'human:event',
    data : inflight_obj
  }, true);
  return false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Emit events and get historical and statistics.
This is available in the **Events** page of Keymetrics.

```javascript
var pmx = require('pmx');

pmx.<span class="apidocCodeKeywordSpan">emit</span>('user:register', {
  user : 'Alex registered',
  email : 'thorustor@gmail.com'
});
```

## Application level network traffic monitoring / Display used ports
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.enableProbe" id="apidoc.element.pmx.pmx.enableProbe">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>enableProbe
        <span class="apidocSignatureSpan">(custom_namespace)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function enableProbes(custom_namespace) {
  if (!custom_namespace)
    custom_namespace = 'axm';

  if (!global[custom_namespace])
    global[custom_namespace] = {};

  if (this.interval)
    return global[custom_namespace];

  this.interval = setInterval(function() {
    Transport.send({
      type : 'axm:monitor',
      data : cookData(global[custom_namespace])
    });
  }, 990);

  this.interval.unref();

  return global[custom_namespace];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.enableProbes" id="apidoc.element.pmx.pmx.enableProbes">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>enableProbes
        <span class="apidocSignatureSpan">(custom_namespace)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function enableProbes(custom_namespace) {
  if (!custom_namespace)
    custom_namespace = 'axm';

  if (!global[custom_namespace])
    global[custom_namespace] = {};

  if (this.interval)
    return global[custom_namespace];

  this.interval = setInterval(function() {
    Transport.send({
      type : 'axm:monitor',
      data : cookData(global[custom_namespace])
    });
  }, 990);

  this.interval.unref();

  return global[custom_namespace];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.exposeProfiling" id="apidoc.element.pmx.pmx.exposeProfiling">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>exposeProfiling
        <span class="apidocSignatureSpan">(pmx, profiler_path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">exposeProfiling = function (pmx, profiler_path) {
  try {
    var profiler = require(profiler_path);
  } catch(e) {
    debug('v8-profiler module not installed', e);
    return false;
  }

  debug('v8-profiler sucessfully enabled');

<span class="apidocCodeCommentSpan">  /**
   * Tell Keymetrics that profiling is possible
   * (flag available in axm_options object)
   */
</span>  Options.configureModule({
    heapdump : true
  });

  /**
   * Heap snapshot
   */
  pmx.action('km:heapdump', function(reply) {
    var dump_file = path.join(os.tmpDir(), Date.now() + '.heapsnapshot');

    var snapshot = profiler.takeSnapshot('km-heap-snapshot');
    var buffer    = '';

    snapshot.serialize(
      function iterator(data, length) {
        buffer += data;
      }, function complete() {
        snapshot.delete();

        fs.writeFile(dump_file, buffer, function (err) {
          debug('Heap dump file flushed (e=', err);

          if (err) {
            return reply({
              success   : false,
              err : err
            });
          }
          return reply({
            success   : true,
            heapdump  : true,
            dump_file : dump_file
          });
        });
      }
    );
  });

  /**
   * CPU profiling snapshot
   */
  var ns_cpu_profiling        = 'km-cpu-profiling';
  var cpu_dump_file = path.join(os.tmpDir(), Date.now() + '.cpuprofile');

  pmx.action('km:cpu:profiling:start', function(reply) {
    profiler.startProfiling(ns_cpu_profiling);
    return reply({ success : true });
  });

  pmx.action('km:cpu:profiling:stop', function(reply) {
    var cpu = profiler.stopProfiling(ns_cpu_profiling);

    fs.writeFile(cpu_dump_file, JSON.stringify(cpu), function(err) {
      if (err) {
        return reply({
          success   : false,
          err : err
        });
      }
      return reply({
        success     : true,
        cpuprofile  : true,
        dump_file   : cpu_dump_file
      });
    });
  });

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  })(require_paths);
};

Profiling.v8Profiling = function(pmx) {
  Profiling.detectV8Profiler(function(err, profiler_path) {
    if (err)
      return false;
    return Profiling.<span class="apidocCodeKeywordSpan">exposeProfiling</span>(pmx, profiler_path);
  });
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.expressErrorHandler" id="apidoc.element.pmx.pmx.expressErrorHandler">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>expressErrorHandler
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">expressErrorHandler = function () {
  var self = this;

  Options.configureModule({
    error : true
  });

  return function errorHandler(err, req, res, next) {
    if (res.statusCode &lt; 400) res.statusCode = 500;

    //debug(err.stack || err);

    err.url = req.url;
    err.component = req.url;
    err.action = req.method;
    err.params = req.body;
    err.session = req.session;

    Transport.send({
      type  : 'process:exception',
      data  : jsonize(err)
    }, true);
    return next(err);
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// All my routes
app.get('/' ...);
app.post(...);
// All my routes

// Here I attach the middleware to get more verbosity on exception thrown
app.use(pmx.<span class="apidocCodeKeywordSpan">expressErrorHandler</span>());
```

## Emit Events

Emit events and get historical and statistics.
This is available in the **Events** page of Keymetrics.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.getConf" id="apidoc.element.pmx.pmx.getConf">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>getConf
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getConf = function () {
  return this._pmx_conf;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  Probe._var[opts.name].alert = new Alert(alert_opts, {name : opts.name});
}
}

Probe.probe = function() {
var self = this;
// Get module configuration to enable alerts
if (this.getConf &amp;&amp; this.<span class="apidocCodeKeywordSpan">getConf</span>())
  Probe._alert_activated = this.getConf().alert_enabled || true;
else
  Probe._alert_activated = false;

if (Probe._started == false) {
  Probe._started = true;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.getEnv" id="apidoc.element.pmx.pmx.getEnv">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>getEnv
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getEnv = function () {
  return process.env;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.getPID" id="apidoc.element.pmx.pmx.getPID">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>getPID
        <span class="apidocSignatureSpan">(file)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getPID = function (file) {
  if (typeof(file) === 'number')
    return file;
  return parseInt(fs.readFileSync(file).toString());
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.http" id="apidoc.element.pmx.pmx.http">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>http
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">http = function (opts) {
  var Module = require('module');

  debug('Wrapping HTTP routes');

  if (Array.isArray(opts)) {
    var routes = JSON.parse(JSON.stringify(opts));
    opts = {
      http          : true,
      http_latency  : 200,
      http_code     : 500,
      ignore_routes : routes
    };
  }
  opts = util._extend({
    http          : true,
    http_latency  : 200,
    http_code     : 500,
    ignore_routes : []
  }, opts);

  Proxy.wrap(Module, '_load', function(load) {
    if (load.__axm_original) {
      debug('HTTP routes have already been wrapped before');

      Options.configureModule({
        latency : opts.http
      });

      if (opts.http === false) {
        return function(file) { return load.__axm_original.apply(this, arguments) };
      } else {
        return function(file) {
          if (file === 'http' || file === 'https')
            return SimpleHttpWrap(opts, load.__axm_original.apply(this, arguments));
          else
            return load.__axm_original.apply(this, arguments);
        };
      }
    }

    return function(file) {
      if (opts.http &amp;&amp;
          (file === 'http' || file === 'https')) {
        debug('http module being required');
        Options.configureModule({
          latency : true
        });
        return SimpleHttpWrap(opts, load.apply(this, arguments));
      }
      else
        return load.apply(this, arguments);
    };
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  PMX.catchPorts();
if (opts.network)
  PMX.catchTraffic();

if (opts.transactions)
  PMX.tracing(PMX, opts);
if (opts.http)
  PMX.<span class="apidocCodeKeywordSpan">http</span>(opts);

PMX.catchAll(opts);

if (opts.profiling)
  Profiling.v8Profiling(PMX);

if (opts.custom_probes == true) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.init" id="apidoc.element.pmx.pmx.init">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>init
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (opts) {
  if (!opts) opts = {};

  opts = util._extend({
    default_actions : true,
    transactions  : false,
    http          : true,
    http_latency  : 200,
    http_code     : 500,
    ignore_routes : [],
    profiling     : true,
    errors        : true,
    // By default if you add alert subfield in custom
    // it's going to be enabled
    alert_enabled : true,
    custom_probes : true,
    network       : false,
    ports         : false,

    // VXX options
    // ignoreFilter.url is aliased to ignore_routes
    ignoreFilter: {
      'url': [],
      'method': ['OPTIONS']
    },
    // 'express', 'hapi', 'http', 'restify'
    excludedHooks: []
  }, opts);

  opts = Configuration.init(opts);
  this._pmx_conf = opts;

  if (opts.ports)
    PMX.catchPorts();
  if (opts.network)
    PMX.catchTraffic();

  if (opts.transactions)
    PMX.tracing(PMX, opts);
  if (opts.http)
    PMX.http(opts);

  PMX.catchAll(opts);

  if (opts.profiling)
    Profiling.v8Profiling(PMX);

  if (opts.custom_probes == true) {
    // Event loop monitoring
    require('./probes/pacemaker.js')(PMX);
  }

  if (opts.default_actions == true) {
    //require('./actions/default.js')(PMX);
  }

  opts.isModule = false;
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
You can monitor the network usage of a specific application by adding the option `network: true` when initializing PMX. If you enable
 the flag `ports: true` when you init pmx it will show which ports your app is listenting on.

These metrics will be shown in the Keymetrics Dashboard in the Custom Metrics section.

Example:

```javascript
pmx.<span class="apidocCodeKeywordSpan">init</span>({
  [...]
  network : true, // Allow application level network monitoring
  ports   : true  // Display ports used by the application
});
```

## Advanced PMX configuration
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.initModule" id="apidoc.element.pmx.pmx.initModule">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>initModule
        <span class="apidocSignatureSpan">(opts, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">initModule = function (opts, cb) {
  if (!opts) opts = {};

  opts = util._extend({
    alert_enabled    : true,
    widget           : {}
  }, opts);

  opts.widget = util._extend({
    type : 'generic',
    logo : 'https://app.keymetrics.io/img/logo/keymetrics-300.png',
    theme            : ['#111111', '#1B2228', '#807C7C', '#807C7C']
  }, opts.widget);

  opts.isModule = true;
  opts = Configuration.init(opts);

  // Force error catching
  PMX.catchAll();

  this._pmx_conf = opts;

  if (cb &amp;&amp; typeof(cb) == 'function')
    return cb(null, opts);

  return opts;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.notify" id="apidoc.element.pmx.pmx.notify">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>notify
        <span class="apidocSignatureSpan">(err)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">notify = function (err) {
  var ret_err = this._interpretError(err);

  // full_err
  //debug(ret_err);

  Transport.send({
    type : 'process:exception',
    data : ret_err
  }, true);

  return ret_err;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
### Custom alert notification

If you need to alert about any critical errors you can do it programmatically:

```javascript
var pmx = require('pmx');

pmx.<span class="apidocCodeKeywordSpan">notify</span>({ success : false });

pmx.notify('This is an error');

pmx.notify(new Error('This is an error'));
```

### Add Verbosity to an Alert: Express Error handler
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.probe" id="apidoc.element.pmx.pmx.probe">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>probe
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">probe = function () {
  var self = this;
  // Get module configuration to enable alerts
  if (this.getConf &amp;&amp; this.getConf())
    Probe._alert_activated = this.getConf().alert_enabled || true;
  else
    Probe._alert_activated = false;

  if (Probe._started == false) {
    Probe._started = true;

    var p_interval = setInterval(function() {
      Transport.send({
        type : 'axm:monitor',
        data : cookData(Probe._var)
      });
      checkIssues(Probe._var);
    }, 990);

    p_interval.unref();
  }

  return {
<span class="apidocCodeCommentSpan">    /**
     * This reflect data to keymetrics
     * pmx.transpose('prop name', fn)
     *
     * or
     *
     * pmx.transpose({
     *   name : 'variable name',
     *   data : function() { return value }
     * });
     */
</span>    transpose : function(variable_name, reporter) {
      if (typeof variable_name === 'object') {
        reporter = variable_name.data;
        variable_name = variable_name.name;
      }

      if (typeof reporter !== 'function') {
        return console.error('[PMX] reporter is not a function');
      }

      Probe._var[variable_name] = {
        value: reporter
      };
    },
    metric : function(opts) {
      var agg_type = opts.agg_type || Probe.default_aggregation;

      if (!opts.name)
        return console.error('[Probe][Metric] Name not defined');
      if (Probe.AVAILABLE_AGG_TYPES.indexOf(agg_type) == -1)
        return console.error("[Probe][Metric] Unknown agg_type: %s", agg_type);

      Probe._var[opts.name] = {
        value   : opts.value || 0,
        agg_type: agg_type
      };

      /**
       * Attach alert to: Probe._var[opts.name].alert
       */
      if (self.getConf)
        attachAlert(opts, self.getConf());

      return {
        val : function() {
          var value = Probe._var[opts.name].value;

          if (typeof(value) == 'function')
            value = value();

          return value;
        },
        set : function(dt) {
          Probe._var[opts.name].value = dt;
        }
      };
    },
    histogram : function(opts) {
      if (!opts.name)
        return console.error('[Probe][Histogram] Name not defined');
      opts.measurement = opts.measurement || 'mean';
      opts.unit = opts.unit || '';
      var agg_type = opts.agg_type || Probe.default_aggregation;

      if (Probe.AVAILABLE_MEASUREMENTS.indexOf(opts.measurement) == -1)
        return console.error('[Probe][Histogram] Measure type %s does not exists', opts.measurement);
      if (Probe.AVAILABLE_AGG_TYPES.indexOf(agg_type) == -1)
        return console.error("[Probe][Metric] Unknown agg_type: %s", agg_type);

      var histogram = new Histogram(opts);

      Probe._var[opts.name] = {
        value: function() { return (Math.round(histogram.val() * 100) / 100) + '' + opts.unit },
        agg_type: agg_type
      };

      /**
       * Attach alert to: Probe._var[opts.name].alert
       */
      if (self.getConf)
        attachAlert(opts, self.getConf());

      return histogram;
    },
    meter : function(opts) {
      var agg_type = opts.agg_type || Probe.default_aggregation;

      if (!opts.name)
        return console.error('[Probe][Meter] Name not defined');
      if (Probe.AVAILABLE_AGG_TYPES.indexOf(agg_type) == -1)
        return console.error("[Probe][Metric] Unknown agg_type: %s", agg_type);

      opts.unit = opts.unit || '';

      var meter = new Meter(opts);

      Probe._var[opts.name] = {
        value: function() { return meter.val() + '' + opts.unit },
        agg_type: agg_type
      };

      /**
       * Attach alert to: Probe._var[opts.name].alert
       */
      if (self.getConf)
        attachAlert(opts, self.getConf());

      return meter;
    },
    counter : function(opts) {
      var agg_type = opts.agg_type || Probe.default_aggregation;

      if (!opts.name)
        return console.error('[Probe][Counter] Name not defined');
      if (Probe.AVAILABLE_AGG_TYPES.indexOf(agg_type) == -1)
        return console.error("[Probe][Metric] Unknown agg_type: %s", agg_type);

      var counter = new Counter();

      Probe._var[opts.name] = {
        value: ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  - eg. Monitor the mean of execution of a query into database

### Metric: Simple value reporting

This allow to expose values that can be read instantly.

```javascript
var probe = pmx.<span class="apidocCodeKeywordSpan">probe</span>();

// Here the value function will be called each second to get the value
// returned by Object.keys(users).length
var metric = probe.metric({
name    : 'Realtime user',
value   : function() {
  return Object.keys(users).length;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.resolvePidPaths" id="apidoc.element.pmx.pmx.resolvePidPaths">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>resolvePidPaths
        <span class="apidocSignatureSpan">(filepaths)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">resolvePidPaths = function (filepaths) {
  if (typeof(filepaths) === 'number')
    return filepaths;

  function detect(filepaths) {
    var content = '';

    filepaths.some(function(filepath) {
      try {
        content = fs.readFileSync(filepath);
      } catch(e) {
        return false;
      }
      return true;
    });

    return content.toString().trim();
  }

  var ret = parseInt(detect(filepaths));

  return isNaN(ret) ? null : ret;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.scopedAction" id="apidoc.element.pmx.pmx.scopedAction">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>scopedAction
        <span class="apidocSignatureSpan">(action_name, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">scopedAction = function (action_name, fn) {

  if (!action_name)
    return console.error('[PMX] action.action_name is missing');
  if (!fn)
    return console.error('[PMX] callback is missing');

  if (!process.send) {
    debug('Process not running within PM2');
    return false;
  }

  // Notify the action
  Transport.send({
    type : 'axm:action',
    data : {
      action_name : action_name,
      action_type : 'scoped'
    }
  });

  process.on('message', function(data) {
    if (!data
        || data.uuid === undefined
        || data.action_name === undefined)
      return false;

    if (data.action_name === action_name) {
      var res = {
        send : function(dt) {
          Transport.send({
            type        : 'axm:scoped_action:stream',
            data        : {
              data        : dt,
              uuid        : data.uuid,
              action_name : action_name
            }
          });
        },
        error : function(dt) {
          Transport.send({
            type        : 'axm:scoped_action:error',
            data        : {
              data        : dt,
              uuid        : data.uuid,
              action_name : action_name
            }
          });
        },
        end : function(dt) {
          Transport.send({
            type        : 'axm:scoped_action:end',
            data        : {
              data        : dt,
              uuid        : data.uuid,
              action_name : action_name
            }
          });
        }
      };

      var d = domain.create();

      d.on('error', function(err) {
        res.error(err.message || err.stack || err);
        setTimeout(function() {
          process.exit(1);
        }, 300);
      });

      d.run(function() {
        fn(data.opts || null, res);
      });
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Scoped Actions are advanced remote actions that can be also triggered from Keymetrics.

Two arguments are passed to the function, data (optional data sent from Keymetrics) and res that allows to emit log data and to
end the scoped action.

Example:

```javascript
pmx.<span class="apidocCodeKeywordSpan">scopedAction</span>('long running lsof', function(data, res) {
var child = spawn('lsof', []);

child.stdout.on('data', function(chunk) {
  chunk.toString().split('\n').forEach(function(line) {
    res.send(line); // This send log to Keymetrics to be saved (for tracking)
  });
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.stopProbe" id="apidoc.element.pmx.pmx.stopProbe">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>stopProbe
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function stopProbing() {
  clearInterval(this.interval);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.stopProbes" id="apidoc.element.pmx.pmx.stopProbes">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>stopProbes
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function stopProbing() {
  clearInterval(this.interval);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.tracing" id="apidoc.element.pmx.pmx.tracing">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>tracing
        <span class="apidocSignatureSpan">(pmx, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tracing = function (pmx, opts) {

  if (Array.isArray(opts.ignore_routes) &amp;&amp; opts.ignore_routes.length &gt; 0) {
    opts.ignoreFilter.url = opts.ignore_routes;
  }

  Transaction.tracer = require('vxx').start(opts);

  Options.configureModule({
    tracing_enabled : true
  });

  // broadcast to pm2 aggregator
  Transaction.tracer.getBus().on('transaction', function(data) {
    Transport.send({
      type: 'axm:trace',
      data: data
    })
  })

  // Transaction.tracer.getBus().on('transaction', function (data) {
  //   if (!opts.custom_probes) return;
  //   // TODO: mine tracing data and require custom probes
  //<span class="apidocCodeCommentSpan">   /*try {
  //     var custom_probe = require('./probes/' + modul)(pmx, Transaction.tracer)
  //   } catch (err) { }*/
</span>  // })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

if (opts.ports)
  PMX.catchPorts();
if (opts.network)
  PMX.catchTraffic();

if (opts.transactions)
  PMX.<span class="apidocCodeKeywordSpan">tracing</span>(PMX, opts);
if (opts.http)
  PMX.http(opts);

PMX.catchAll(opts);

if (opts.profiling)
  Profiling.v8Profiling(PMX);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.pmx.v8Profiling" id="apidoc.element.pmx.pmx.v8Profiling">
        function <span class="apidocSignatureSpan">pmx.pmx.</span>v8Profiling
        <span class="apidocSignatureSpan">(pmx)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">v8Profiling = function (pmx) {
  Profiling.detectV8Profiler(function(err, profiler_path) {
    if (err)
      return false;
    return Profiling.exposeProfiling(pmx, profiler_path);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  PMX.tracing(PMX, opts);
if (opts.http)
  PMX.http(opts);

PMX.catchAll(opts);

if (opts.profiling)
  Profiling.<span class="apidocCodeKeywordSpan">v8Profiling</span>(PMX);

if (opts.custom_probes == true) {
  // Event loop monitoring
  require('./probes/pacemaker.js')(PMX);
}

if (opts.default_actions == true) {
...</pre></li>
    </ul>












</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.profiling" id="apidoc.module.pmx.profiling">module pmx.profiling</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.profiling.detectV8Profiler" id="apidoc.element.pmx.profiling.detectV8Profiler">
        function <span class="apidocSignatureSpan">pmx.profiling.</span>detectV8Profiler
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">detectV8Profiler = function (cb) {
  var require_paths = require.main.paths.slice();

  (function look_for_profiler(require_paths) {
    if (!require_paths[0])
      return cb(new Error('Module not found'));

    var profiler_path = path.join(require_paths[0], 'v8-profiler');

    fs.exists(profiler_path, function(exist) {
      if (exist)
        return cb(null, profiler_path);

      require_paths.shift();
      return look_for_profiler(require_paths);
    });
    return false;
  })(require_paths);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      return look_for_profiler(require_paths);
    });
    return false;
  })(require_paths);
};

Profiling.v8Profiling = function(pmx) {
  Profiling.<span class="apidocCodeKeywordSpan">detectV8Profiler</span>(function(err, profiler_path) {
    if (err)
      return false;
    return Profiling.exposeProfiling(pmx, profiler_path);
  });
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.profiling.exposeProfiling" id="apidoc.element.pmx.profiling.exposeProfiling">
        function <span class="apidocSignatureSpan">pmx.profiling.</span>exposeProfiling
        <span class="apidocSignatureSpan">(pmx, profiler_path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">exposeProfiling = function (pmx, profiler_path) {
  try {
    var profiler = require(profiler_path);
  } catch(e) {
    debug('v8-profiler module not installed', e);
    return false;
  }

  debug('v8-profiler sucessfully enabled');

<span class="apidocCodeCommentSpan">  /**
   * Tell Keymetrics that profiling is possible
   * (flag available in axm_options object)
   */
</span>  Options.configureModule({
    heapdump : true
  });

  /**
   * Heap snapshot
   */
  pmx.action('km:heapdump', function(reply) {
    var dump_file = path.join(os.tmpDir(), Date.now() + '.heapsnapshot');

    var snapshot = profiler.takeSnapshot('km-heap-snapshot');
    var buffer    = '';

    snapshot.serialize(
      function iterator(data, length) {
        buffer += data;
      }, function complete() {
        snapshot.delete();

        fs.writeFile(dump_file, buffer, function (err) {
          debug('Heap dump file flushed (e=', err);

          if (err) {
            return reply({
              success   : false,
              err : err
            });
          }
          return reply({
            success   : true,
            heapdump  : true,
            dump_file : dump_file
          });
        });
      }
    );
  });

  /**
   * CPU profiling snapshot
   */
  var ns_cpu_profiling        = 'km-cpu-profiling';
  var cpu_dump_file = path.join(os.tmpDir(), Date.now() + '.cpuprofile');

  pmx.action('km:cpu:profiling:start', function(reply) {
    profiler.startProfiling(ns_cpu_profiling);
    return reply({ success : true });
  });

  pmx.action('km:cpu:profiling:stop', function(reply) {
    var cpu = profiler.stopProfiling(ns_cpu_profiling);

    fs.writeFile(cpu_dump_file, JSON.stringify(cpu), function(err) {
      if (err) {
        return reply({
          success   : false,
          err : err
        });
      }
      return reply({
        success     : true,
        cpuprofile  : true,
        dump_file   : cpu_dump_file
      });
    });
  });

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  })(require_paths);
};

Profiling.v8Profiling = function(pmx) {
  Profiling.detectV8Profiler(function(err, profiler_path) {
    if (err)
      return false;
    return Profiling.<span class="apidocCodeKeywordSpan">exposeProfiling</span>(pmx, profiler_path);
  });
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.profiling.v8Profiling" id="apidoc.element.pmx.profiling.v8Profiling">
        function <span class="apidocSignatureSpan">pmx.profiling.</span>v8Profiling
        <span class="apidocSignatureSpan">(pmx)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">v8Profiling = function (pmx) {
  Profiling.detectV8Profiler(function(err, profiler_path) {
    if (err)
      return false;
    return Profiling.exposeProfiling(pmx, profiler_path);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  PMX.tracing(PMX, opts);
if (opts.http)
  PMX.http(opts);

PMX.catchAll(opts);

if (opts.profiling)
  Profiling.<span class="apidocCodeKeywordSpan">v8Profiling</span>(PMX);

if (opts.custom_probes == true) {
  // Event loop monitoring
  require('./probes/pacemaker.js')(PMX);
}

if (opts.default_actions == true) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.proxy" id="apidoc.module.pmx.proxy">module pmx.proxy</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.proxy.wrap" id="apidoc.element.pmx.proxy.wrap">
        function <span class="apidocSignatureSpan">pmx.proxy.</span>wrap
        <span class="apidocSignatureSpan">(object, methods, hook)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">wrap = function (object, methods, hook) {
  var self = this;

  if (!Array.isArray(methods)) methods = [methods];

  for (var i = 0; i &lt; methods.length; ++i) {
    debug('Wrapping method:', methods[i]);
    var original = object[methods[i]];
    if (!original) return debug('Method %s unknown', methods[i]);
    if (original.__axm_original) {
      debug('Already wrapped', methods[i]);
      if (methods[i] != '_load')
        return;
    }
    var hooked = hook(original);

    if (original.__axm_original) {
      hooked.__axm_original = original.__axm_original;
    }
    else {
      hooked.__axm_original = original;
    }
    object[methods[i]] = hooked;
    //debug('Method proxified');
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  opts = util._extend({
    http          : true,
    http_latency  : 200,
    http_code     : 500,
    ignore_routes : []
  }, opts);

  Proxy.<span class="apidocCodeKeywordSpan">wrap</span>(Module, '_load', function(load) {
    if (load.__axm_original) {
debug('HTTP routes have already been wrapped before');

Options.configureModule({
  latency : opts.http
});
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.sample" id="apidoc.module.pmx.sample">module pmx.sample</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.sample.sample" id="apidoc.element.pmx.sample.sample">
        function <span class="apidocSignatureSpan">pmx.</span>sample
        <span class="apidocSignatureSpan">(size)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sample = function (size) {
  this._elements = [];
  this._size = size || 300;
  this._sum = 0;
  this._count = 0;
  this._varianceM = 0;
  this._varianceS = 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.sample.prototype" id="apidoc.module.pmx.sample.prototype">module pmx.sample.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.sample.prototype.getMean" id="apidoc.element.pmx.sample.prototype.getMean">
        function <span class="apidocSignatureSpan">pmx.sample.prototype.</span>getMean
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getMean = function () {
  return (this._count === 0)
    ? 0
    : this._sum / this._count;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (typeof(opts.value) === 'undefined')
    return console.error('[Probe][Metric][threshold-avg] Val undefined!');
  this.sample = new Sample(opts.interval || 180);
  this.cmp = function(value, threshold) {
    this.sample.update(parseFloat(value));
    if (this.start) {
      if (typeof(opts.cmp) !== 'undefined' &amp;&amp; opts.cmp !== null)
        return opts.cmp(this.sample.<span class="apidocCodeKeywordSpan">getMean</span>(), threshold);
      return cmp(this.sample.getMean(), threshold);
    }
  };
  break;
case 'smart':
  this.sample = new Sample(opts.interval || 300);
  this.small = new Sample(opts.sample || 30);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.sample.prototype.getStddev" id="apidoc.element.pmx.sample.prototype.getStddev">
        function <span class="apidocSignatureSpan">pmx.sample.prototype.</span>getStddev
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getStddev = function () {
  return (this._count &lt; 2)
    ? 1
    : Math.sqrt(this.getVariance());
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    case 'smart':
this.sample = new Sample(opts.interval || 300);
this.small = new Sample(opts.sample || 30);
this.cmp = function(value, threshold) {
  if (value !== null) {
    this.sample.update(parseFloat(value));
    this.small.update(parseFloat(value));
  //debug('Check', value, Math.exp(- Math.pow(value - this.sample.getMean(), 2) / (2 * this.sample.getVariance())) / (
Math.sqrt(2 * Math.PI) * this.sample.<span class="apidocCodeKeywordSpan">getStddev</span>()));

    if (this.start)
    //return false
      return (Math.exp(- Math.pow(value - this.sample.getMean(), 2) / (2 * this.sample.getVariance())) / (Math.sqrt(2 * Math.PI) *
this.sample.getStddev()) &lt; 0.00000001)
  }
  return false;
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.sample.prototype.getVariance" id="apidoc.element.pmx.sample.prototype.getVariance">
        function <span class="apidocSignatureSpan">pmx.sample.prototype.</span>getVariance
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getVariance = function () {
  return (this._count &lt; 2)
    ? 1
    :  this._varianceS / (this._count -1)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    case 'smart':
this.sample = new Sample(opts.interval || 300);
this.small = new Sample(opts.sample || 30);
this.cmp = function(value, threshold) {
  if (value !== null) {
    this.sample.update(parseFloat(value));
    this.small.update(parseFloat(value));
  //debug('Check', value, Math.exp(- Math.pow(value - this.sample.getMean(), 2) / (2 * this.sample.<span class="apidocCodeKeywordSpan
">getVariance</span>())) / (Math.sqrt(2 * Math.PI) * this.sample.getStddev()));

    if (this.start)
    //return false
      return (Math.exp(- Math.pow(value - this.sample.getMean(), 2) / (2 * this.sample.getVariance())) / (Math.sqrt(2 * Math.PI) *
this.sample.getStddev()) &lt; 0.00000001)
  }
  return false;
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.sample.prototype.update" id="apidoc.element.pmx.sample.prototype.update">
        function <span class="apidocSignatureSpan">pmx.sample.prototype.</span>update
        <span class="apidocSignatureSpan">(value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">update = function (value) {
  if (this._count &gt;= this._size) {
    this._elements.push(value);
    this._sum += (value - this._elements.shift());
  }
  else {
    this._count++;
    this._elements.push(value);
    this._sum += value;
    var oldM = this._varianceM;
    this._varianceM += ((value - oldM) / this._count);
    this._varianceS += ((value - oldM) * (value - this._varianceM));
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  measurement : 'mean'
});

var latency = 0;

setInterval(function() {
  latency = Math.round(Math.random() * 100);
  histogram.<span class="apidocCodeKeywordSpan">update</span>(latency);
}, 100);
```

#### Options

- **name**: Probe name
- **agg_type** : (optional)(default: none) Can be `sum`, `max`, `min`, `avg` (default) or `none`. It will impact the way the probe
 data are aggregated within the **Keymetrics** backend. Use `none` if this is irrelevant (eg: constant or string value).
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.transaction" id="apidoc.module.pmx.transaction">module pmx.transaction</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.transaction.http" id="apidoc.element.pmx.transaction.http">
        function <span class="apidocSignatureSpan">pmx.transaction.</span>http
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">http = function (opts) {
  var Module = require('module');

  debug('Wrapping HTTP routes');

  if (Array.isArray(opts)) {
    var routes = JSON.parse(JSON.stringify(opts));
    opts = {
      http          : true,
      http_latency  : 200,
      http_code     : 500,
      ignore_routes : routes
    };
  }
  opts = util._extend({
    http          : true,
    http_latency  : 200,
    http_code     : 500,
    ignore_routes : []
  }, opts);

  Proxy.wrap(Module, '_load', function(load) {
    if (load.__axm_original) {
      debug('HTTP routes have already been wrapped before');

      Options.configureModule({
        latency : opts.http
      });

      if (opts.http === false) {
        return function(file) { return load.__axm_original.apply(this, arguments) };
      } else {
        return function(file) {
          if (file === 'http' || file === 'https')
            return SimpleHttpWrap(opts, load.__axm_original.apply(this, arguments));
          else
            return load.__axm_original.apply(this, arguments);
        };
      }
    }

    return function(file) {
      if (opts.http &amp;&amp;
          (file === 'http' || file === 'https')) {
        debug('http module being required');
        Options.configureModule({
          latency : true
        });
        return SimpleHttpWrap(opts, load.apply(this, arguments));
      }
      else
        return load.apply(this, arguments);
    };
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  PMX.catchPorts();
if (opts.network)
  PMX.catchTraffic();

if (opts.transactions)
  PMX.tracing(PMX, opts);
if (opts.http)
  PMX.<span class="apidocCodeKeywordSpan">http</span>(opts);

PMX.catchAll(opts);

if (opts.profiling)
  Profiling.v8Profiling(PMX);

if (opts.custom_probes == true) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pmx.transaction.tracing" id="apidoc.element.pmx.transaction.tracing">
        function <span class="apidocSignatureSpan">pmx.transaction.</span>tracing
        <span class="apidocSignatureSpan">(pmx, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tracing = function (pmx, opts) {

  if (Array.isArray(opts.ignore_routes) &amp;&amp; opts.ignore_routes.length &gt; 0) {
    opts.ignoreFilter.url = opts.ignore_routes;
  }

  Transaction.tracer = require('vxx').start(opts);

  Options.configureModule({
    tracing_enabled : true
  });

  // broadcast to pm2 aggregator
  Transaction.tracer.getBus().on('transaction', function(data) {
    Transport.send({
      type: 'axm:trace',
      data: data
    })
  })

  // Transaction.tracer.getBus().on('transaction', function (data) {
  //   if (!opts.custom_probes) return;
  //   // TODO: mine tracing data and require custom probes
  //<span class="apidocCodeCommentSpan">   /*try {
  //     var custom_probe = require('./probes/' + modul)(pmx, Transaction.tracer)
  //   } catch (err) { }*/
</span>  // })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

if (opts.ports)
  PMX.catchPorts();
if (opts.network)
  PMX.catchTraffic();

if (opts.transactions)
  PMX.<span class="apidocCodeKeywordSpan">tracing</span>(PMX, opts);
if (opts.http)
  PMX.http(opts);

PMX.catchAll(opts);

if (opts.profiling)
  Profiling.v8Profiling(PMX);
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pmx.transport" id="apidoc.module.pmx.transport">module pmx.transport</a></h1>


    <h2>
        <a href="#apidoc.element.pmx.transport.send" id="apidoc.element.pmx.transport.send">
        function <span class="apidocSignatureSpan">pmx.transport.</span>send
        <span class="apidocSignatureSpan">(args, print)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">send = function (args, print) {
  if (!print) print = false;

  ipcSend(args, print);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

```javascript
pmx.scopedAction('long running lsof', function(data, res) {
var child = spawn('lsof', []);

child.stdout.on('data', function(chunk) {
  chunk.toString().split('\n').forEach(function(line) {
    res.<span class="apidocCodeKeywordSpan">send</span>(line); // This send log to Keymetrics to be saved (for tracking)
  });
});

child.stdout.on('end', function(chunk) {
  res.end('end'); // This end the scoped action
});
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>